{"version":3,"sources":["webpack://pcs/webpack/universalModuleDefinition","webpack://pcs/webpack/bootstrap","webpack://pcs/./src/transform/Polyfill.js","webpack://pcs/./src/transform/ElementUtilities.js","webpack://pcs/./src/transform/CollapseTable.js","webpack://pcs/./src/transform/SectionUtilities.ts","webpack://pcs/./src/transform/NodeUtilities.js","webpack://pcs/./src/transform/EditTransform.js","webpack://pcs/./src/transform/LazyLoadTransform.ts","webpack://pcs/./src/transform/CollectionUtilities.js","webpack://pcs/./src/transform/ElementGeometry.js","webpack://pcs/./src/transform/Throttle.js","webpack://pcs/./src/transform/PlatformTransform.js","webpack://pcs/./src/transform/ThemeTransform.js","webpack://pcs/./src/transform/FooterContainer.js","webpack://pcs/./src/transform/FooterLegal.js","webpack://pcs/./src/transform/FooterMenu.js","webpack://pcs/./src/transform/FooterReadMore.js","webpack://pcs/./src/transform/ReferenceCollection.js","webpack://pcs/./src/transform/AdjustTextSize.ts","webpack://pcs/./src/transform/BodySpacingTransform.ts","webpack://pcs/./src/transform/DimImagesTransform.js","webpack://pcs/./src/transform/LazyLoadTransformer.js","webpack://pcs/./src/pcs/c1/Footer.js","webpack://pcs/./src/pcs/c1/InteractionHandling.js","webpack://pcs/./src/pcs/c1/L10N.js","webpack://pcs/./src/pcs/c1/Scroller.js","webpack://pcs/./src/pcs/index.js","webpack://pcs/./src/pcs/c1/index.js","webpack://pcs/./node_modules/banana-i18n/dist/banana-i18n.js","webpack://pcs/./src/pcs/c1/Page.js","webpack://pcs/./src/pcs/c1/Platforms.js","webpack://pcs/./src/pcs/c1/Sections.js","webpack://pcs/./src/pcs/c1/Themes.js"],"names":["root","factory","exports","module","define","amd","this","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","CustomEvent","window","type","parameters","bubbles","cancelable","detail","undefined","event","document","createEvent","initCustomEvent","matchesSelector","el","selector","matches","webkitMatchesSelector","querySelectorAll","element","Array","slice","findClosestAncestor","parentElement","Polyfill","isNestedInTable","Boolean","closestInlineStyle","thisValue","style","e","isVisible","offsetWidth","offsetHeight","getClientRects","length","copyAttributesToDataAttributes","source","destination","attributes","filter","attribute","hasAttribute","forEach","setAttribute","getAttribute","copyDataAttributesToAttributes","NODE_TYPE","NodeUtilities","CLASS","ICON","CONTAINER","COLLAPSED_CONTAINER","COLLAPSED","COLLAPSED_BOTTOM","COLLAPSE_TEXT","EXPANDED","TABLE_INFOBOX","TABLE_OTHER","TABLE","isHeaderEligible","header","isHeaderTextEligible","headerText","replace","firstWordFromString","string","match","isNodeTextContentSimilarToPageTitle","node","pageTitle","firstPageTitleWord","firstNodeTextContentWord","textContent","toLowerCase","stringWithNormalizedWhitespace","trim","replaceNodeWithBreakingSpaceTextNode","parentNode","replaceChild","createTextNode","extractEligibleHeaderText","fragment","createDocumentFragment","appendChild","cloneNode","fragmentHeader","querySelector","remove","cur","lastChild","isNodeTypeElementOrText","previousSibling","nextSibling","nodeType","ELEMENT_NODE","tagName","getTableHeaderTextArray","headerTextArray","walker","createTreeWalker","nextNode","indexOf","push","toggleCollapsedForContainer","container","trigger","footerDivClickCallback","children","table","footer","caption","collapsed","display","classList","add","visibility","toggleCollapseClickCallback","shouldTableBeCollapsed","blacklistIntersects","some","clazz","contains","isHidden","isInfobox","newCollapsedHeaderDiv","content","div","createElement","newCollapsedFooterDiv","innerHTML","newCaptionFragment","title","titleClass","strong","span","prepareTable","tableTitle","tableClass","footerTitle","captionFragment","containerDiv","className","nodeToReplace","replacementNode","childOfSectionTag","sectionTag","foundSectionTag","SectionUtilities","isMediaWikiSectionElement","insertBefore","removeChild","replaceNodeInSection","collapsedHeaderDiv","collapsedFooterDiv","contentDiv","prepareTables","infoboxTitle","otherTitle","tables","ElementUtilities","isBox","toggleCollapsedForAll","setupEventHandling","isInitiallyCollapsed","dispatchSectionToggledEvent","dispatchEvent","onclick","adjustTables","isMainPage","SECTION_TOGGLED_EVENT_TYPE","collapseTables","expandCollapsedTableIfItContainsElement","containerSelector","collapsedDiv","firstElementChild","click","test","default","BASE","SHOW","HIDE","HIDEABLE","ID","CONTENT","CONTROL","getControlIdForSectionId","sectionId","getContentIdForSectionId","setHidden","hidden","controlId","contentId","control","getElementById","createFoldHR","section","hr","expandCollapsedSectionIfItContainsElement","parent","id","getTopLevelSectionIdForElement","getSectionIDOfElement","current","getSectionOfElement","getLeadParagraphText","firstParagraphInASection","innerText","getSectionOffsets","body","sections","reduce","results","heading","parseInt","yOffset","offsetTop","prepareForHiding","getControl","toRemove","nextElementSibling","TEXT_NODE","getBoundingClientRectAsPlainObject","rect","getBoundingClientRect","top","right","bottom","left","width","height","x","y","SECTION_HEADER","TITLE","LINK_CONTAINER","LINK","PROTECTION","UNPROTECTED","PROTECTED","FORBIDDEN","IDS","TITLE_DESCRIPTION","ADD_TITLE_DESCRIPTION","DIVIDER","PRONUNCIATION","DATA_ATTRIBUTE","SECTION_INDEX","ACTION","PRONUNCIATION_URL","DESCRIPTION_SOURCE","newEditSectionLink","index","href","link","newEditSectionButton","actualLink","newEditSectionWrapper","appendEditSectionHeader","wrapper","newEditSectionHeader","level","titleHTML","showEditPencil","button","titleDescriptionElements","titleDescription","titleDescriptionSource","addTitleDescriptionString","isTitleDescriptionEditable","a","setEditButtons","isEditable","isProtected","documentElement","newEditLeadSectionHeader","pageDisplayTitle","pronunciationURL","descriptionElements","divider","ElementGeometry","CLASSES","PLACEHOLDER_CLASS","PLACEHOLDER_PENDING_CLASS","PLACEHOLDER_LOADING_CLASS","PLACEHOLDER_ERROR_CLASS","IMAGE_LOADING_CLASS","IMAGE_LOADED_CLASS","COPY_ATTRIBUTES","UNIT_TO_MINIMUM_LAZY_LOAD_SIZE","px","ex","em","convertImageToPlaceholder","image","placeholder","geometry","from","setProperty","spacing","ratio","heightValue","widthValue","isLazyLoadable","minWidth","widthUnit","Infinity","minHeight","heightUnit","queryLazyLoadableImages","convertImagesToPlaceholders","images","map","loadPlaceholder","retryListener","stopPropagation","preventDefault","addEventListener","removeEventListener","once","collectPageIssueElements","sectionJSON","closest","headerEl","anchor","collectHatnotes","titles","html","links","collectPageIssues","styleRegex","DimensionUnit","unit","_value","Number","_unit","getPropertyValue","fromStyle","isNaN","_width","_height","fromElement","NaN","Throttle","period","funktion","_window","_period","_function","_context","_arguments","_result","_timeout","_timestamp","throttle","throttled","queue","arguments","result","pending","delay","cancel","reset","context","args","setTimeout","Date","now","apply","Math","max","clearTimeout","ANDROID","CLASS_PREFIX","IOS","classify","navigator","userAgent","isAndroid","isIOs","setPlatform","platform","THEME","DEFAULT","DARK","SEPIA","BLACK","setThemeOnElement","theme","setTheme","pcs","containerFragment","menuSection","readMoreSection","legalSection","isContainerAttached","licenseString","licenseSubstitutionString","containerID","licenseLinkClickHandler","viewInBrowserString","browserLinkClickHandler","linkText","halves","split","buildLicenseHtml","MenuItemType","languages","lastEdited","pageIssues","disambiguation","coordinate","talkPage","MenuItem","subtitle","itemType","clickHandler","payload","CollectionUtilities","setHeading","headingString","headingID","headingElement","maybeAddItem","item","extractor","payloadExtractor","menuItem","role","containerAnchor","iconClass","documentFragmentForMenuItem","addItem","safelyRemoveEnclosures","opener","closer","enclosureRegex","RegExp","counter","stringToClean","previousString","cleanExtract","ReadMorePage","displayTitle","thumbnail","description","extract","showReadMorePages","pages","sectionContainerId","pageContainerId","titlesShownHandler","shownTitles","sectionContainer","pageContainer","page","normalized","pageFragment","readMorePage","outerAnchorContainer","backgroundImage","innerDivContainer","encodeURI","titleToShow","descriptionEl","documentFragmentForReadMorePage","fetchAndAdd","count","baseURL","xhr","XMLHttpRequest","open","readMoreQueryURL","onload","JSON","parse","responseText","rand","floor","random","send","hasFragmentPrefix","fragmentPrefix","decodedHref","decodeURIComponent","decodedFragment","relativePath","isCitation","isWhitespaceTextNode","Node","hasCitationLink","hash","getRefTextContainer","refTextContainerID","collectRefText","refTextContainer","refTextSpan","closestReferenceClassElement","sourceNode","ReferenceItem","text","ReferenceLinkItem","NearbyReferences","selectedIndex","referencesGroup","adjacentNonWhitespaceNode","siblingGetter","currentNode","collectAdjacentReferenceNodes","nodeCollector","prevSiblingGetter","nextSiblingGetter","collectNearbyReferenceNodes","collectedNodes","unshift","collectNearbyReferenceForReferenceElement","referenceElement","referenceNodes","referenceItemForNode","collectNearbyReferences","sourceNodeParent","collectNearbyReferencesAsText","referenceLinkItemForNode","collectReferencesForBackLink","target","backLinkHrefs","backLinksJSON","getBackLinks","referenceId","referenceText","backLinks","firstBackLinkHref","isBackLink","BACK_LINK_ANCHOR","BACK_LINK_CONTAINER","BODY","BODY_HEADER","BODY_CONTENT","REF","BACK_LINK_FRAGMENT_PREFIX","BACK_LINK_ATTRIBUTE","setPercentage","textSize","setMargins","bodyElement","values","marginTop","marginRight","marginBottom","marginLeft","setPadding","paddingTop","paddingRight","paddingBottom","paddingLeft","dimImages","enable","areImagesDimmed","dim","isDim","EVENT_TYPES","CollapseTable","loadDistanceMultiplier","_loadDistanceMultiplier","_placeholders","_registered","_throttledLoadPlaceholders","wrap","_loadPlaceholders","LazyLoadTransform","placeholders","concat","_register","eventType","_isPlaceholderEligibleToLoad","deregister","_isPlaceholderWithinLoadDistance","bounds","range","innerHeight","handlers","FooterMenu","params","articleTitle","menu","menuItems","items","languageCount","editedDaysAgo","readMore","readMoreItemCount","itemCount","readMoreBaseURL","FooterContainer","finish","banana","i18n","footerItemSelected","FooterReadMore","titlesRetrieved","FooterLegal","viewLicense","viewInBrowser","location","stringsURL","failsafeBanana","message","response","Banana","locale","load","messages","onerror","_connectHandlers","newHandlers","Actions","InitialSetup","FinalSetup","LinkClicked","ImageClicked","ReferenceClicked","BackLink","EditSection","AddTitleDescription","PronunciationClicked","ScrollToAnchor","FooterItemSelected","SaveOtherPage","ReadMoreTitlesRetrieved","ViewLicense","ViewInBrowser","interactionHandler","Interaction","action","data","ItemType","ClickedItem","pageLinkTitle","ReferenceCollection","postMessage","interaction","canonicalFileHref","postMessageForClickedItem","substring","canonicalHref","src","postMessageForImage","innerPlaceholderSpan","outerSpan","postMessageForImagePlaceholder","nearbyReferences","postMessageForReferenceWithTarget","postMessageForBackLinkWithTarget","saveOtherPage","getSelectionInfo","optionalWindow","selection","getSelection","toString","anchorNode","isTitleDescription","setInteractionHandler","myHandlerFunction","Footer","anchorForTarget","linkElement","head","linkHref","components","pop","url","EditTransform","descriptionElement","descriptionSource","handleClickEvent","initialSetupComplete","finalSetupComplete","scrollToAnchor","selectors","addTitleDescription","tableInfobox","tableOther","tableClose","localizeLabels","localizedStrings","entries","elements","scrollTop","setScrollTop","newValue","scrollWithDecorOffset","scrollTo","testing","getScrollTop","c1","InteractionHandling","L10N","Platforms","Page","Scroller","Sections","Themes","u","getPluralForm","min","Intl","PluralRules","resolvedOptions","pluralCategories","select","includes","digitTransformTable","String","parseFloat","bs","dsb","fi","ga","he","hsb","hu","hy","la","os","ru","sl","uk","f","h","b","k","g","v","z","w","$","j","M","O","S","G","P","q","F","join","Error","emitter","language","emit","convertNumber","convertPlural","gender","convertGrammar","simpleParse","sourceMap","Map","has","set","assign","parser","messageStore","finalFallback","getMessage","getFallbackLocales","unitsRegex","waitForNextPaint","onSuccess","requestAnimationFrame","setup","optionalSettings","settings","PlatformTransform","l10n","ThemeTransform","DimImagesTransform","metaTags","margins","leadImageHeight","getMetaTags","getLeadImageFromMetaTags","units","BodySpacingTransform","userGroups","protection","getProtectionFromMetaTags","edit","setupTableEventHandling","areTablesInitiallyExpanded","textSizeAdjustmentPercentage","AdjustTextSize","loadImages","lazyLoader","LazyLoadTransformer","collectExistingPlaceholders","loadPlaceholders","Function","protectionPrefixLength","metaTag","startsWith","removeHighlightsFromHighlightedElements","widthString","heightString","onBodyStart","pcsClient","getSetupSettings","setupJSON","pcsSetupSettings","onReceiveMessage","pcsActionHandler","stringify","console","log","initialSetupCompletion","preSettings","defaultInitialSettings","onBodyEnd","remainingContentTimeout","postSettings","remainingTimeout","setDimImages","setTextSizeAdjustmentPercentage","getLeadImage","getProtection","getRevision","about","lastIndexOf","getTableOfContents","levelCounts","fill","lastLevel","charAt","number","prepareForScrollToAnchor","options","highlight","getScroller","getOffsets"],"mappings":"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","file":"wikimedia-page-library-pcs.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"pcs\"] = factory();\n\telse\n\t\troot[\"pcs\"] = factory();\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 34);\n","/**\n * Polyfill function that tells whether a given element matches a selector.\n * @param {!Element} el Element\n * @param {!string} selector Selector to look for\n * @return {!boolean} Whether the element matches the selector\n */\nconst matchesSelector = (el, selector) => {\n  if (el.matches) {\n    return el.matches(selector)\n  }\n  if (el.matchesSelector) {\n    return el.matchesSelector(selector)\n  }\n  if (el.webkitMatchesSelector) {\n    return el.webkitMatchesSelector(selector)\n  }\n  return false\n}\n\n/**\n * @param {!Element} element\n * @param {!string} selector\n * @return {!Array.<Element>}\n */\nconst querySelectorAll = (element, selector) =>\n  Array.prototype.slice.call(element.querySelectorAll(selector))\n\n// https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent#Polyfill\n// Required by Android API 16 AOSP Nexus S emulator.\n// eslint-disable-next-line no-undef\nconst CustomEvent = typeof window !== 'undefined' && window.CustomEvent\n  || function(type, parameters = { bubbles: false, cancelable: false, detail: undefined }) {\n    // eslint-disable-next-line no-undef\n    const event = document.createEvent('CustomEvent')\n    event.initCustomEvent(type, parameters.bubbles, parameters.cancelable, parameters.detail)\n    return event\n  }\n\nexport default {\n  matchesSelector,\n  querySelectorAll,\n  CustomEvent\n}","import Polyfill from './Polyfill'\n\n// todo: drop ancestor consideration and move to Polyfill.closest().\n/**\n * Returns closest ancestor of element which matches selector.\n * Similar to 'closest' methods as seen here:\n *  https://api.jquery.com/closest/\n *  https://developer.mozilla.org/en-US/docs/Web/API/Element/closest\n * @param  {!Element} el        Element\n * @param  {!string} selector   Selector to look for in ancestors of 'el'\n * @return {?HTMLElement}       Closest ancestor of 'el' matching 'selector'\n */\nconst findClosestAncestor = (el, selector) => {\n  let parentElement\n  for (parentElement = el.parentElement;\n    parentElement && !Polyfill.matchesSelector(parentElement, selector);\n    parentElement = parentElement.parentElement) {\n    // Intentionally empty.\n  }\n  return parentElement\n}\n\n/**\n * @param {?Element} element\n * @param {!string} property\n * @param {?string} value\n * @return {?Element} The inclusive first element with an inline style (and optional value) or\n * undefined.\n */\nconst closestInlineStyle = (element, property, value) => {\n  for (let el = element; el; el = el.parentElement) {\n    let thisValue\n\n    // Wrap in a try-catch block to avoid Domino crashing on a malformed style declaration.\n    // T229521\n    try {\n      thisValue = el.style[property]\n    } catch (e) {\n      continue\n    }\n\n    if (thisValue) {\n      if (value === undefined) {\n        return el\n      }\n      if (value === thisValue) {\n        return el\n      }\n    }\n  }\n  return undefined\n}\n\n/**\n * Determines if element has a table ancestor.\n * @param  {!Element}  el   Element\n * @return {!boolean}       Whether table ancestor of 'el' is found\n */\nconst isNestedInTable = el => Boolean(findClosestAncestor(el, 'table'))\n\n/**\n * @param {!HTMLElement} element\n * @return {!boolean} true if element affects layout, false otherwise.\n */\nconst isVisible = element =>\n  // https://github.com/jquery/jquery/blob/305f193/src/css/hiddenVisibleSelectors.js#L12\n  Boolean(element.offsetWidth || element.offsetHeight || element.getClientRects().length)\n\n/**\n * Copy existing attributes from source to destination as data-* attributes.\n * @param {!HTMLElement} source\n * @param {!HTMLElement} destination\n * @param {!Array.<string>} attributes\n * @return {void}\n */\nconst copyAttributesToDataAttributes = (source, destination, attributes) => {\n  attributes.filter(attribute => source.hasAttribute(attribute))\n    .forEach(attribute =>\n      destination.setAttribute(`data-${attribute}`, source.getAttribute(attribute)))\n}\n\n/**\n * Copy existing data-* attributes from source to destination as attributes.\n * @param {!HTMLElement} source\n * @param {!HTMLElement} destination\n * @param {!Array.<string>} attributes\n * @return {void}\n */\nconst copyDataAttributesToAttributes = (source, destination, attributes) => {\n  attributes.filter(attribute => source.hasAttribute(`data-${attribute}`))\n    .forEach(attribute =>\n      destination.setAttribute(attribute, source.getAttribute(`data-${attribute}`)))\n}\n\nexport default {\n  findClosestAncestor,\n  isNestedInTable,\n  closestInlineStyle,\n  isVisible,\n  copyAttributesToDataAttributes,\n  copyDataAttributesToAttributes\n}","import './CollapseTable.css'\nimport ElementUtilities from './ElementUtilities'\nimport NodeUtilities from './NodeUtilities'\nimport Polyfill from './Polyfill'\nimport SectionUtilities from './SectionUtilities'\n\nconst NODE_TYPE = NodeUtilities.NODE_TYPE\n\nconst SECTION_TOGGLED_EVENT_TYPE = 'section-toggled'\nconst BREAKING_SPACE = ' '\nconst CLASS = {\n  ICON: 'pcs-collapse-table-icon',\n  CONTAINER: 'pcs-collapse-table-container',\n  COLLAPSED_CONTAINER: 'pcs-collapse-table-collapsed-container',\n  COLLAPSED: 'pcs-collapse-table-collapsed',\n  COLLAPSED_BOTTOM: 'pcs-collapse-table-collapsed-bottom',\n  COLLAPSE_TEXT: 'pcs-collapse-table-collapse-text',\n  EXPANDED: 'pcs-collapse-table-expanded',\n  TABLE_INFOBOX: 'pcs-table-infobox',\n  TABLE_OTHER: 'pcs-table-other',\n  TABLE: 'pcs-collapse-table'\n}\n\n/**\n * Determine if we want to extract text from this header.\n * @param {!Element} header\n * @return {!boolean}\n */\nconst isHeaderEligible =\n  header => Polyfill.querySelectorAll(header, 'a').length < 3\n\n/**\n * Determine eligibility of extracted text.\n * @param {?string} headerText\n * @return {!boolean}\n */\nconst isHeaderTextEligible = headerText =>\n  headerText && headerText.replace(/[\\s0-9]/g, '').length > 0\n\n/**\n * Extracts first word from string. Returns null if for any reason it is unable to do so.\n * @param  {!string} string\n * @return {?string}\n */\nconst firstWordFromString = string => {\n  // 'If the global flag (g) is not set, Element zero of the array contains the entire match,\n  // while elements 1 through n contain any submatches.'\n  const matches = string.match(/\\w+/) // Only need first match so not using 'g' option.\n  if (!matches) {\n    return undefined\n  }\n  return matches[0]\n}\n\n/**\n * Is node's textContent too similar to pageTitle. Checks if the first word of the node's\n * textContent is found at the beginning of pageTitle.\n * @param  {!Node} node\n * @param  {!string} pageTitle\n * @return {!boolean}\n */\nconst isNodeTextContentSimilarToPageTitle = (node, pageTitle) => {\n  const firstPageTitleWord = firstWordFromString(pageTitle)\n  const firstNodeTextContentWord = firstWordFromString(node.textContent)\n  // Don't claim similarity if 1st words were not extracted.\n  if (!firstPageTitleWord || !firstNodeTextContentWord) {\n    return false\n  }\n  return firstPageTitleWord.toLowerCase() === firstNodeTextContentWord.toLowerCase()\n}\n\n/**\n * Removes leading and trailing whitespace and normalizes other whitespace - i.e. ensures\n * non-breaking spaces, tabs, etc are replaced with regular breaking spaces.\n * @param  {!string} string\n * @return {!string}\n */\nconst stringWithNormalizedWhitespace = string => string.trim().replace(/\\s/g, BREAKING_SPACE)\n\n/**\n * Determines if node is a BR.\n * @param  {!Node}  node\n * @return {!boolean}\n */\nconst isNodeBreakElement = node => node.nodeType === NODE_TYPE.ELEMENT_NODE && node.tagName === 'BR'\n\n/**\n * Replace node with a text node bearing a single breaking space.\n * @param {!Document} document\n * @param  {!Node} node\n * @return {void}\n */\nconst replaceNodeWithBreakingSpaceTextNode = (document, node) => {\n  /* DOM sink status: safe - content transform with no user interference */\n  node.parentNode.replaceChild(document.createTextNode(BREAKING_SPACE), node)\n}\n\n/**\n * Extracts any header text determined to be eligible.\n * @param {!Document} document\n * @param {!Element} header\n * @param {?string} pageTitle\n * @return {?string}\n */\nconst extractEligibleHeaderText = (document, header, pageTitle) => {\n  if (!isHeaderEligible(header)) {\n    return null\n  }\n  // Clone header into fragment. This is done so we can remove some elements we don't want\n  // represented when \"textContent\" is used. Because we've cloned the header into a fragment, we are\n  // free to strip out anything we want without worrying about affecting the visible document.\n  const fragment = document.createDocumentFragment()\n  fragment.appendChild(header.cloneNode(true))\n  const fragmentHeader = fragment.querySelector('th')\n\n  Polyfill.querySelectorAll(\n    fragmentHeader, '.geo, .coordinates, sup.mw-ref, ol, ul, style, script'\n  ).forEach(el => el.remove())\n\n  let cur = fragmentHeader.lastChild\n  while (cur) {\n    if (pageTitle\n      && NodeUtilities.isNodeTypeElementOrText(cur)\n      && isNodeTextContentSimilarToPageTitle(cur, pageTitle)) {\n      if (cur.previousSibling) {\n        cur = cur.previousSibling\n        cur.nextSibling.remove()\n      } else {\n        cur.remove()\n        cur = undefined\n      }\n    } else if (isNodeBreakElement(cur)) {\n      replaceNodeWithBreakingSpaceTextNode(document, cur)\n      cur = cur.previousSibling\n    } else {\n      cur = cur.previousSibling\n    }\n  }\n\n  const headerText = fragmentHeader.textContent\n  if (isHeaderTextEligible(headerText)) {\n    return stringWithNormalizedWhitespace(headerText)\n  }\n  return null\n}\n\n/**\n * Find an array of table header (TH) contents. If there are no TH elements in\n * the table or the header's link matches pageTitle, an empty array is returned.\n * @param {!Document} document\n * @param {!Element} element\n * @param {?string} pageTitle Unencoded page title; if this title matches the\n *                            contents of the header exactly, it will be omitted.\n * @return {!Array<string>}\n */\nconst getTableHeaderTextArray = (document, element, pageTitle) => {\n  const headerTextArray = []\n\n  const walker = document.createTreeWalker(element)\n  let header = walker.nextNode()\n  while (header) {\n    if (header.tagName !== 'TH') {\n      header = walker.nextNode()\n      continue;\n    }\n    const headerText = extractEligibleHeaderText(document, header, pageTitle)\n    if (headerText && headerTextArray.indexOf(headerText) === -1) {\n      headerTextArray.push(headerText)\n      // 'newCaptionFragment' only ever uses the first 2 items.\n      if (headerTextArray.length === 2) {\n        break\n      }\n    }\n    header = walker.nextNode()\n  }\n  return headerTextArray\n}\n\n/**\n * @typedef {function} FooterDivClickCallback\n * @param {!HTMLElement}\n * @return {void}\n */\n\n/**\n * @param {!Element} container div\n * @param {?Element} trigger element that was clicked or tapped\n * @param {?FooterDivClickCallback} footerDivClickCallback\n * @return {boolean} true if collapsed, false if expanded.\n */\nconst toggleCollapsedForContainer = function(container, trigger, footerDivClickCallback) {\n  const header = container.children[0]\n  const table = container.children[1]\n  const footer = container.children[2]\n  const caption = header.querySelector('.app-table-collapsed-caption')\n  const collapsed = table.style.display !== 'none'\n  if (collapsed) {\n    table.style.display = 'none'\n    header.classList.remove(CLASS.COLLAPSED)\n    header.classList.remove(CLASS.ICON)\n    header.classList.add(CLASS.EXPANDED)\n    if (caption) {\n      caption.style.visibility = 'visible'\n    }\n    footer.style.display = 'none'\n    // if they clicked the bottom div, then scroll back up to the top of the table.\n    if (trigger === footer && footerDivClickCallback) {\n      footerDivClickCallback(container)\n    }\n  } else {\n    table.style.display = 'block'\n    header.classList.remove(CLASS.EXPANDED)\n    header.classList.add(CLASS.COLLAPSED)\n    header.classList.add(CLASS.ICON)\n    if (caption) {\n      caption.style.visibility = 'hidden'\n    }\n    footer.style.display = 'block'\n  }\n  return collapsed\n}\n\n/**\n * Ex: toggleCollapseClickCallback.bind(el, (container) => {\n *       window.scrollTo(0, container.offsetTop - transformer.getDecorOffset())\n *     })\n * @this HTMLElement\n * @param {?FooterDivClickCallback} footerDivClickCallback\n * @return {boolean} true if collapsed, false if expanded.\n */\nconst toggleCollapseClickCallback = function(footerDivClickCallback) {\n  const container = this.parentNode\n  return toggleCollapsedForContainer(container, this, footerDivClickCallback)\n}\n\n/**\n * @param {!HTMLElement} table\n * @return {!boolean} true if table should be collapsed, false otherwise.\n */\nconst shouldTableBeCollapsed = table => {\n  const classBlacklist = ['navbox', 'vertical-navbox', 'navbox-inner', 'metadata', 'mbox-small']\n  const blacklistIntersects = classBlacklist.some(clazz => table.classList.contains(clazz))\n  let isHidden\n  // Wrap in a try-catch block to avoid Domino crashing on a malformed style declaration.\n  // T229521\n  try {\n    isHidden = table.style.display === 'none'\n  } catch (e) {\n    // If Domino fails to parse styles, err on the safe side and don't transform\n    isHidden = true\n  }\n  return !isHidden && !blacklistIntersects\n}\n\n/**\n * @param {!Element} element\n * @return {!boolean} true if element is an infobox, false otherwise.\n */\nconst isInfobox = element =>\n  element.classList.contains('infobox')\n  || element.classList.contains('infobox_v3')\n\n/**\n * @param {!Document} document\n * @param {!DocumentFragment} content\n * @return {!HTMLDivElement}\n */\nconst newCollapsedHeaderDiv = (document, content) => {\n  const div = document.createElement('div')\n  div.classList.add(CLASS.COLLAPSED_CONTAINER)\n  div.classList.add(CLASS.EXPANDED)\n  /* DOM sink status: risk? - content come from newCaptionFragment which is potentially risky */\n  div.appendChild(content)\n  return div\n}\n\n/**\n * @param {!Document} document\n * @param {?string} content HTML string.\n * @return {!HTMLDivElement}\n */\nconst newCollapsedFooterDiv = (document, content) => {\n  const div = document.createElement('div')\n  div.classList.add(CLASS.COLLAPSED_BOTTOM)\n  div.classList.add(CLASS.ICON)\n  /* DOM sink status: risk? - footer title can be overridden by the client */\n  div.innerHTML = content || ''\n  return div\n}\n\n/**\n * @param {!Document} document\n * @param {!string} title\n * @param {!string} titleClass\n * @param {!Array.<string>} headerText\n * @return {!DocumentFragment}\n */\nconst newCaptionFragment = (document, title, titleClass, headerText) => {\n  const fragment = document.createDocumentFragment()\n\n  const strong = document.createElement('strong')\n  /* DOM sink status: risk? - title can be overridden by clients */\n  strong.innerHTML = title\n  strong.classList.add(titleClass)\n  fragment.appendChild(strong)\n\n  const span = document.createElement('span')\n  span.classList.add(CLASS.COLLAPSE_TEXT)\n  if (headerText.length > 0) {\n    /* DOM sink status: safe - content from parsoid output */\n    span.appendChild(document.createTextNode(`: ${headerText[0]}`))\n  }\n  if (headerText.length > 1) {\n    /* DOM sink status: safe - content from parsoid output */\n    span.appendChild(document.createTextNode(`, ${headerText[1]}`))\n  }\n  if (headerText.length > 0) {\n  /* DOM sink status: safe - content transform with no user interference */\n    span.appendChild(document.createTextNode(' '))\n  }\n  /* DOM sink status: safe - content from parsoid output */\n  fragment.appendChild(span)\n\n  return fragment\n}\n\n/**\n * @param {!Node} nodeToReplace\n * @param {!Node} replacementNode\n * @return {void}\n */\nconst replaceNodeInSection = (nodeToReplace, replacementNode) => {\n  if (!nodeToReplace || !replacementNode) {\n    return\n  }\n  let childOfSectionTag = nodeToReplace\n  let sectionTag = nodeToReplace.parentNode\n  if (!sectionTag) {\n    return\n  }\n  let foundSectionTag = false\n  while (sectionTag) {\n    if (SectionUtilities.isMediaWikiSectionElement(sectionTag)) {\n      foundSectionTag = true\n      break\n    }\n    childOfSectionTag = sectionTag\n    sectionTag = sectionTag.parentNode\n  }\n  if (!foundSectionTag) {\n    childOfSectionTag = nodeToReplace\n    sectionTag = nodeToReplace.parentNode\n  }\n  sectionTag.insertBefore(replacementNode, childOfSectionTag)\n  sectionTag.removeChild(childOfSectionTag)\n}\n\n/**\n * @param {!DOMElement} table\n * @param {!Document} document\n * @param {?string} pageTitle use title for this not `display title` (which can contain tags)\n * @param {?string} tableTitle title for the table\n * @param {?string} tableClass css class\n * @param {!Array<string>} headerTextArray array of header text strings\n * @param {?string} footerTitle\n * @return {void}\n */\nconst prepareTable = (table, document, pageTitle, tableTitle,\n  tableClass, headerTextArray, footerTitle) => {\n\n  const captionFragment =\n    newCaptionFragment(\n      document,\n      tableTitle,\n      tableClass,\n      headerTextArray)\n\n  // create the container div that will contain both the original table\n  // and the collapsed version.\n  const containerDiv = document.createElement('div')\n  containerDiv.className = CLASS.CONTAINER\n  replaceNodeInSection(table, containerDiv)\n\n  // ensure the table doesn't float\n  table.classList.add(CLASS.TABLE)\n\n  const collapsedHeaderDiv = newCollapsedHeaderDiv(document, captionFragment)\n  collapsedHeaderDiv.style.display = 'block'\n\n  const collapsedFooterDiv = newCollapsedFooterDiv(document, footerTitle)\n  collapsedFooterDiv.style.display = 'none'\n\n  // add our stuff to the container\n  /* DOM sink status: risk? - collapsedHeaderDiv is potentially risk */\n  containerDiv.appendChild(collapsedHeaderDiv)\n  /* DOM sink status: safe - content from parsoid output */\n\n  // Add a wrapper div for content to allow for overflow scrolling\n  const contentDiv = document.createElement('div')\n  contentDiv.appendChild(table)\n  containerDiv.appendChild(contentDiv)\n\n  /* DOM sink status: risk? - collapsedFooterDiv is potentially risk */\n  containerDiv.appendChild(collapsedFooterDiv)\n\n  // set initial visibility\n  contentDiv.style.display = 'none'\n}\n/**\n * @param {!Document} document\n * @param {?string} pageTitle use title for this not `display title` (which can contain tags)\n * @param {?string} infoboxTitle\n * @param {?string} otherTitle\n * @param {?string} footerTitle\n * @return {void}\n */\nconst prepareTables = (document, pageTitle, infoboxTitle, otherTitle, footerTitle) => {\n  const tables = document.querySelectorAll('table, .infobox_v3')\n  for (let i = 0; i < tables.length; ++i) {\n    const table = tables[i]\n    if (ElementUtilities.findClosestAncestor(table, `.${CLASS.CONTAINER}`)\n      || !shouldTableBeCollapsed(table)) {\n      continue\n    }\n    const isBox = isInfobox(table)\n    const headerTextArray = getTableHeaderTextArray(document, table, pageTitle)\n    if (!headerTextArray.length && !isBox) {\n      continue\n    }\n    const title = isBox ? infoboxTitle : otherTitle\n    const cls = isBox ? CLASS.TABLE_INFOBOX : CLASS.TABLE_OTHER\n    prepareTable(table, document, pageTitle, title, cls, headerTextArray, footerTitle)\n  }\n}\n\n/**\n * @param {!Element} container root element to search from\n * @return {void}\n */\nconst toggleCollapsedForAll = container => {\n  const containerDivs = Polyfill.querySelectorAll(container, `.${CLASS.CONTAINER}`)\n  containerDivs.forEach(containerDiv => {\n    toggleCollapsedForContainer(containerDiv)\n  })\n}\n\n/**\n * @param {!Window} window\n * @param {!Element} container root element to search from\n * @param {?boolean} isInitiallyCollapsed\n * @param {?FooterDivClickCallback} footerDivClickCallback\n * @return {void}\n */\nconst setupEventHandling = (window, container, isInitiallyCollapsed, footerDivClickCallback) => {\n  /**\n   * @param {boolean} collapsed\n   * @return {boolean}\n   */\n  const dispatchSectionToggledEvent = collapsed =>\n    window.dispatchEvent(new Polyfill.CustomEvent(SECTION_TOGGLED_EVENT_TYPE, { collapsed }))\n\n  // assign click handler to the collapsed divs\n  const collapsedHeaderDivs = Polyfill.querySelectorAll(container, `.${CLASS.COLLAPSED_CONTAINER}`)\n  collapsedHeaderDivs.forEach(collapsedHeaderDiv => {\n    collapsedHeaderDiv.onclick = () => {\n      const collapsed = toggleCollapseClickCallback.bind(collapsedHeaderDiv)()\n      dispatchSectionToggledEvent(collapsed)\n    }\n  })\n\n  const collapsedFooterDivs = Polyfill.querySelectorAll(container, `.${CLASS.COLLAPSED_BOTTOM}`)\n  collapsedFooterDivs.forEach(collapsedFooterDiv => {\n    collapsedFooterDiv.onclick = () => {\n      const collapsed = toggleCollapseClickCallback.bind(collapsedFooterDiv,\n        footerDivClickCallback)()\n      dispatchSectionToggledEvent(collapsed)\n    }\n  })\n\n  if (!isInitiallyCollapsed) {\n    toggleCollapsedForAll(container)\n  }\n}\n\n/**\n * @param {!Window} window\n * @param {!Document} document\n * @param {?string} pageTitle use title for this not `display title` (which can contain tags)\n * @param {?boolean} isMainPage\n * @param {?boolean} isInitiallyCollapsed\n * @param {?string} infoboxTitle\n * @param {?string} otherTitle\n * @param {?string} footerTitle\n * @param {?FooterDivClickCallback} footerDivClickCallback\n * @return {void}\n */\nconst adjustTables = (window, document, pageTitle, isMainPage, isInitiallyCollapsed,\n  infoboxTitle, otherTitle, footerTitle, footerDivClickCallback) => {\n  if (isMainPage) { return }\n\n  prepareTables(document, pageTitle, infoboxTitle, otherTitle, footerTitle)\n  setupEventHandling(window, document, isInitiallyCollapsed, footerDivClickCallback)\n}\n\n/**\n * @param {!Window} window\n * @param {!Document} document\n * @param {?string} pageTitle use title for this not `display title` (which can contain tags)\n * @param {?boolean} isMainPage\n * @param {?string} infoboxTitle\n * @param {?string} otherTitle\n * @param {?string} footerTitle\n * @param {?FooterDivClickCallback} footerDivClickCallback\n * @return {void}\n */\nconst collapseTables = (window, document, pageTitle, isMainPage, infoboxTitle, otherTitle,\n  footerTitle, footerDivClickCallback) => {\n  adjustTables(window, document, pageTitle, isMainPage, true, infoboxTitle, otherTitle,\n    footerTitle, footerDivClickCallback)\n}\n\n/**\n * If you tap a reference targeting an anchor within a collapsed table, this\n * method will expand the references section. The client can then scroll to the\n * references section.\n *\n * The first reference (an \"[A]\") in the \"enwiki > Airplane\" article from ~June\n * 2016 exhibits this issue. (You can copy wikitext from this revision into a\n * test wiki page for testing.)\n * @param  {?Element} element\n * @return {void}\n*/\nconst expandCollapsedTableIfItContainsElement = element => {\n  if (element) {\n    const containerSelector = `[class*=\"${CLASS.CONTAINER}\"]`\n    const container = ElementUtilities.findClosestAncestor(element, containerSelector)\n    if (container) {\n      const collapsedDiv = container.firstElementChild\n      if (collapsedDiv && collapsedDiv.classList.contains(CLASS.EXPANDED)) {\n        collapsedDiv.click()\n      }\n    }\n  }\n}\n\nexport default {\n  CLASS,\n  SECTION_TOGGLED_EVENT_TYPE,\n  toggleCollapsedForAll,\n  toggleCollapseClickCallback,\n  collapseTables,\n  getTableHeaderTextArray,\n  adjustTables,\n  prepareTables,\n  prepareTable,\n  setupEventHandling,\n  expandCollapsedTableIfItContainsElement,\n  test: {\n    extractEligibleHeaderText,\n    firstWordFromString,\n    shouldTableBeCollapsed,\n    isHeaderEligible,\n    isHeaderTextEligible,\n    isInfobox,\n    newCollapsedHeaderDiv,\n    newCollapsedFooterDiv,\n    newCaptionFragment,\n    isNodeTextContentSimilarToPageTitle,\n    stringWithNormalizedWhitespace,\n    replaceNodeWithBreakingSpaceTextNode,\n    getTableHeaderTextArray\n  }\n}","const Polyfill = require('./Polyfill').default\n/**\n * get Section Offsets object to handle quick scrolling in the table of contents\n * @param  {!HTMLBodyElement} body HTML body element DOM object.\n * @return {!object} section offsets object\n */\nconst getSectionOffsets = (body: HTMLBodyElement): object => {\n    const sections = Polyfill.querySelectorAll(body, 'section')\n    return {\n        sections: sections.reduce((results: Array<object>, section: HTMLElement) => {\n            const id = section.getAttribute('data-mw-section-id');\n            const heading = section &&\n                section.firstElementChild &&\n                section.firstElementChild.querySelector('.pcs-edit-section-title');\n            if (id && parseInt(id) >= 1) {\n                results.push({\n                    heading: heading && heading.innerHTML,\n                    id: parseInt(id),\n                    yOffset: section.offsetTop,\n                });\n            }\n            return results;\n        }, [])\n    }\n}\n\n/**\n * Get section of a given element\n * @param  {!Element} element\n * @return {!Element} section\n */\nconst getSectionOfElement = (element: Element): Element | null => {\n    let current: Element | null = element\n    while (current) {\n        if (isMediaWikiSectionElement(current)) {\n            return current\n        }\n        current = current.parentElement\n    }\n    return null\n}\n\n/**\n * Get section id of a given element\n * @param  {!Element} element\n * @return {!Element} section\n */\nconst getSectionIDOfElement = (element: Element): string | null => {\n    let section = getSectionOfElement(element)\n    return section && section.getAttribute('data-mw-section-id')\n}\n\n/**\n * Get lead paragraph text\n * @param  {!Document} document object.\n * @return {!string} lead paragraph text\n */\nconst getLeadParagraphText = (document: Document): string => {\n    let firstParagraphInASection = <HTMLElement>document.querySelector('#content-block-0>p');\n    return firstParagraphInASection && firstParagraphInASection.innerText || '';\n}\n\n\n/**\n * @param {!Element} element - element to test\n * @return {boolean} true if this is a element that represents a MediaWiki section\n */\nconst isMediaWikiSectionElement = (element: Element): boolean => {\n    if (!element) {\n        return false\n    }\n    // mobile-html output has `data-mw-section-id` attributes on section tags\n    if (element.tagName === 'SECTION' && element.getAttribute('data-mw-section-id')) {\n        return true\n    }\n    return false\n}\n\nconst CLASS = {\n    CONTROL: {\n        BASE: 'pcs-section-control',\n        SHOW: 'pcs-section-control-show',\n        HIDE: 'pcs-section-control-hide'\n    },\n    SECTION: {\n        HIDE: 'pcs-section-hidden'\n    },\n    HEADER: {\n        HIDEABLE: 'pcs-section-hideable-header'\n    }\n}\n\nconst ID = {\n    PREFIX: {\n        CONTENT: 'pcs-section-content-',\n        CONTROL: 'pcs-section-control-'\n    }\n}\n\nconst getControlIdForSectionId = (sectionId: string): string => {\n    return ID.PREFIX.CONTROL + sectionId\n}\n\nconst getContentIdForSectionId = (sectionId: string): string => {\n    return ID.PREFIX.CONTENT + sectionId\n}\n/**\n * @param {!Document} document - document for the control\n * @param {!string} sectionId - sectionId for the control\n * @return {Element} the control element\n */\nconst getControl = (document: Document, sectionId: string): Element => {\n    const control: Element = document.createElement('span')\n    control.id = getControlIdForSectionId(sectionId)\n    control.classList.add(CLASS.CONTROL.BASE)\n    control.classList.add(CLASS.CONTROL.SHOW)\n    return control\n}\n\nconst prepareForHiding = (document: Document, sectionId: string, section: Element, header: Element) => {\n    const control: Element = getControl(document, sectionId)\n    if (header && control) {\n        header.appendChild(control)\n        header.classList.add(CLASS.HEADER.HIDEABLE)\n        header.setAttribute('onclick', `pcs.c1.Sections.setHidden('${sectionId}', false);`)\n    }\n    let el = section.firstElementChild\n    const div = document.createElement('div')\n    while (el) {\n        const toRemove = el\n        el = el.nextElementSibling\n        if (toRemove === header) {\n            continue;\n        }\n        section.removeChild(toRemove)\n        div.appendChild(toRemove)\n    }\n    div.id = getContentIdForSectionId(sectionId)\n    div.classList.add(CLASS.SECTION.HIDE)\n    section.appendChild(div)\n}\n\nconst setHidden = (document: Document, sectionId: string, hidden: boolean = true) => {\n    const controlId: string = getControlIdForSectionId(sectionId)\n    const contentId: string = getContentIdForSectionId(sectionId)\n    const control = document.getElementById(controlId)\n    const content = document.getElementById(contentId)\n    if (!control || !content) {\n        return\n    }\n    if (hidden) {\n        control.classList.remove(CLASS.CONTROL.HIDE)\n        control.classList.add(CLASS.CONTROL.SHOW)\n        content.classList.add(CLASS.SECTION.HIDE)\n    } else {\n        control.classList.remove(CLASS.CONTROL.SHOW)\n        control.classList.add(CLASS.CONTROL.HIDE)\n        content.classList.remove(CLASS.SECTION.HIDE)\n    }\n    const header = control.parentElement\n    if (!header) {\n        return\n    }\n    header.setAttribute('onclick', `pcs.c1.Sections.setHidden('${sectionId}', ${!hidden});`)\n}\n\nconst getTopLevelSectionIdForElement = (element: Element): string | undefined => {\n    let parent: Element | null = element\n    while ((parent = parent.parentElement)) {\n        if (parent.tagName !== 'SECTION') {\n            continue\n        }\n        if (!parent.parentElement || parent.parentElement.id !== 'pcs') {\n            continue\n        }\n        const sectionId = parent.getAttribute('data-mw-section-id')\n        if (!sectionId) {\n            continue\n        }\n        return sectionId\n    }\n    return\n}\n\nconst expandCollapsedSectionIfItContainsElement = (document: Document, element: Element) => {\n    const sectionId = getTopLevelSectionIdForElement(element)\n    if (!sectionId) {\n        return\n    }\n    setHidden(document, sectionId, false)\n}\n\n// Adds a HR before the indicated section\n// Used to separate article content from collapsed sections\nconst createFoldHR = (document: Document, section: Element) => {\n    if (!section.parentElement) {\n        return\n    }\n    const hr: Element = document.createElement('hr')\n    hr.classList.add('pcs-fold-hr')\n    section.parentElement.insertBefore(hr, section);\n}\n\n\nexport default {\n    createFoldHR,\n    expandCollapsedSectionIfItContainsElement,\n    getSectionIDOfElement,\n    getLeadParagraphText,\n    getSectionOffsets,\n    prepareForHiding,\n    setHidden,\n    getControlIdForSectionId,\n    isMediaWikiSectionElement\n}","// Node is undefined in Node.js\nconst NODE_TYPE = {\n  ELEMENT_NODE: 1,\n  TEXT_NODE: 3\n}\n\n/**\n * Determines if node is either an element or text node.\n * @param  {!Node} node\n * @return {!boolean}\n */\nconst isNodeTypeElementOrText = node =>\n  node.nodeType === NODE_TYPE.ELEMENT_NODE || node.nodeType === NODE_TYPE.TEXT_NODE\n\n\n/**\n * Get node's bounding rect as a plain object.\n * @param {!Node} node\n * @return {!Object<string, number>}\n */\nconst getBoundingClientRectAsPlainObject = node => {\n  const rect = node.getBoundingClientRect()\n  return {\n    top: rect.top,\n    right: rect.right,\n    bottom: rect.bottom,\n    left: rect.left,\n    width: rect.width,\n    height: rect.height,\n    x: rect.x,\n    y: rect.y\n  }\n}\n\nexport default {\n  isNodeTypeElementOrText,\n  getBoundingClientRectAsPlainObject,\n  NODE_TYPE\n}","import './EditTransform.css'\n\nconst CLASS = {\n  SECTION_HEADER: 'pcs-edit-section-header',\n  TITLE: 'pcs-edit-section-title',\n  LINK_CONTAINER: 'pcs-edit-section-link-container',\n  LINK: 'pcs-edit-section-link',\n  PROTECTION: { UNPROTECTED: '', PROTECTED: 'page-protected', FORBIDDEN: 'no-editing' }\n}\n\nconst IDS = {\n  TITLE_DESCRIPTION: 'pcs-edit-section-title-description',\n  ADD_TITLE_DESCRIPTION: 'pcs-edit-section-add-title-description',\n  DIVIDER: 'pcs-edit-section-divider',\n  PRONUNCIATION: 'pcs-edit-section-title-pronunciation'\n}\n\nconst DATA_ATTRIBUTE = {\n  SECTION_INDEX: 'data-id',\n  ACTION: 'data-action',\n  PRONUNCIATION_URL: 'data-pronunciation-url',\n  DESCRIPTION_SOURCE: 'data-description-source'\n}\nconst ACTION_EDIT_SECTION = 'edit_section'\nconst ACTION_TITLE_PRONUNCIATION = 'title_pronunciation'\nconst ACTION_ADD_TITLE_DESCRIPTION = 'add_title_description'\n\n/**\n * Enables edit buttons to be shown (and which ones: protected or regular).\n * @param {!HTMLDocument} document\n * @param {?boolean} isEditable true if edit buttons should be shown\n * @param {?boolean} isProtected true if the protected edit buttons should be shown\n * @return {void}\n */\nconst setEditButtons = (document, isEditable = false, isProtected = false) => {\n  const classList = document.documentElement.classList\n  if (isEditable) {\n    classList.remove(CLASS.PROTECTION.FORBIDDEN)\n  } else {\n    classList.add(CLASS.PROTECTION.FORBIDDEN)\n  }\n  if (isProtected) {\n    classList.add(CLASS.PROTECTION.PROTECTED)\n  } else {\n    classList.remove(CLASS.PROTECTION.PROTECTED)\n  }\n}\n\n/**\n * @param {!Document} document\n * @param {!number} index The zero-based index of the section.\n * @param {!string} href The href for the link\n * @return {!HTMLAnchorElement}\n */\nconst newEditSectionLink = (document, index, href = '') => {\n  const link = document.createElement('a')\n  link.href = href\n  link.setAttribute(DATA_ATTRIBUTE.SECTION_INDEX, index)\n  link.setAttribute(DATA_ATTRIBUTE.ACTION, ACTION_EDIT_SECTION)\n  link.classList.add(CLASS.LINK)\n  return link\n}\n\n/**\n * @param {!Document} document\n * @param {!number} index The zero-based index of the section.\n * @param {!HTMLElement} link The link element\n * @return {!HTMLSpanElement}\n */\nconst newEditSectionButton = (document, index, link) => {\n  const container = document.createElement('span')\n  container.classList.add(CLASS.LINK_CONTAINER)\n\n  let actualLink = link\n  if (!actualLink) {\n    actualLink = newEditSectionLink(document, index)\n  }\n  /* DOM sink status: safe - content transform with no user interference */\n  container.appendChild(actualLink)\n\n  return container\n}\n\n/**\n * @param {!Document} document\n * @param {!number} index The zero-based index of the section.\n * @return {!HTMLDivElement}\n */\nconst newEditSectionWrapper = (document, index) => {\n  const element = document.createElement('div')\n  element.className = CLASS.SECTION_HEADER\n  return element\n}\n\n/**\n * @param {!HTMLDivElement} wrapper\n * @param {!HTMLElement} header The header element.\n * @return {void}\n */\nconst appendEditSectionHeader = (wrapper, header) => {\n  header.classList.add(CLASS.TITLE)\n  /* DOM sink status: safe - content transform with no user interference */\n  wrapper.appendChild(header)\n}\n\n/**\n * As a client, you may wish to set the ID attribute.\n * @param {!Document} document\n * @param {!number} index The zero-based index of the section.\n * @param {!number} level The *one-based* header or table of contents level.\n * @param {?string} titleHTML Title of this section header.\n * @param {?boolean} showEditPencil Whether to show the \"edit\" pencil (default is true).\n * @return {!HTMLElement}\n */\nconst newEditSectionHeader = (document, index, level, titleHTML, showEditPencil = true) => {\n\n  const element = newEditSectionWrapper(document, index)\n  const title = document.createElement(`h${level}`)\n  /* DOM sink status: safe - content is created from mwapi call output */\n  title.innerHTML = titleHTML || ''\n  title.setAttribute(DATA_ATTRIBUTE.SECTION_INDEX, index)\n  appendEditSectionHeader(element, title)\n\n  if (showEditPencil) {\n    const button = newEditSectionButton(document, index)\n    element.appendChild(button)\n  }\n  return element\n}\n\n/**\n * Elements needed to show or add page title description.\n * @param {!Document} document\n * @param {?string} titleDescription Page title description.\n * @param {?string} titleDescriptionSource\n * @param {?string} addTitleDescriptionString Localized string e.g. 'Add title description'.\n * @param {?boolean} isTitleDescriptionEditable Whether title description is editable.\n * @return {?HTMLElement}\n */\nconst titleDescriptionElements = (document, titleDescription, titleDescriptionSource, addTitleDescriptionString,\n  isTitleDescriptionEditable) => {\n  const descriptionExists = titleDescription !== undefined && titleDescription.length > 0\n  if (descriptionExists) {\n    const p = document.createElement('p')\n    p.setAttribute(DATA_ATTRIBUTE.DESCRIPTION_SOURCE, titleDescriptionSource)\n    p.id = IDS.TITLE_DESCRIPTION\n    p.innerHTML = titleDescription\n    return p\n  }\n  if (isTitleDescriptionEditable) {\n    const a = document.createElement('a')\n    a.href = '#'\n    a.setAttribute(DATA_ATTRIBUTE.ACTION, ACTION_ADD_TITLE_DESCRIPTION)\n    const p = document.createElement('p')\n    p.id = IDS.ADD_TITLE_DESCRIPTION\n    p.innerHTML = addTitleDescriptionString\n    a.appendChild(p)\n    return a\n  }\n  return null\n}\n\n/**\n * Lead section header is a special case as it needs to show page title and description too,\n * and in addition to the lead edit pencil, the description can also be editable.\n * As a client, you may wish to set the ID attribute.\n * @param {!Document} document\n * @param {?string} pageDisplayTitle Page display title.\n * @param {?string} titleDescription Page title description.\n * @param {?string} titleDescriptionSource Page title description source - \"central\" or \"local\".\n * @param {?string} addTitleDescriptionString Localized string e.g. 'Add title description'.\n * @param {?boolean} isTitleDescriptionEditable Whether title description is editable.\n * @param {?boolean} showEditPencil Whether to show the \"edit\" pencil (default is true).\n * @param {?string} pronunciationURL URL for the pronunciation - will show the speaker when provided.\n * @return {!HTMLElement}\n */\nconst newEditLeadSectionHeader = (document, pageDisplayTitle, titleDescription, titleDescriptionSource,\n  addTitleDescriptionString, isTitleDescriptionEditable, showEditPencil = true,\n  pronunciationURL) => {\n\n  const container = document.createDocumentFragment()\n\n  const header = newEditSectionHeader(document, 0, 1, pageDisplayTitle, showEditPencil)\n\n  if (pronunciationURL) {\n    const a = document.createElement('a')\n    a.setAttribute(DATA_ATTRIBUTE.ACTION, ACTION_TITLE_PRONUNCIATION)\n    a.setAttribute(DATA_ATTRIBUTE.PRONUNCIATION_URL, pronunciationURL)\n    a.id = IDS.PRONUNCIATION\n    header.querySelector('h1').appendChild(a)\n  }\n\n  container.appendChild(header)\n\n  const descriptionElements = titleDescriptionElements(document, titleDescription,\n    titleDescriptionSource, addTitleDescriptionString, isTitleDescriptionEditable)\n\n  if (descriptionElements) {\n    container.appendChild(descriptionElements)\n  }\n\n  const divider = document.createElement('hr')\n  divider.id = IDS.DIVIDER\n  container.appendChild(divider)\n\n  return container\n}\n\nexport default {\n  appendEditSectionHeader,\n  CLASS,\n  IDS,\n  DATA_ATTRIBUTE,\n  setEditButtons,\n  newEditSectionButton,\n  newEditSectionHeader,\n  newEditSectionWrapper,\n  newEditLeadSectionHeader,\n  newEditSectionLink\n}","import './LazyLoadTransform.css'\n// todo: use imports when other modules are TypeScript.\nconst ElementGeometry = require('./ElementGeometry').default\nconst ElementUtilities = require('./ElementUtilities').default\nconst Polyfill = require('./Polyfill').default\n\n// CSS classes used to identify and present lazily loaded images. Placeholders are members of\n// PLACEHOLDER_CLASS and one state class: pending, loading, or error. Images are members of either\n// loading or loaded state classes. Class names should match those in LazyLoadTransform.css.\nconst PLACEHOLDER_CLASS = 'pcs-lazy-load-placeholder'\nconst PLACEHOLDER_PENDING_CLASS = 'pcs-lazy-load-placeholder-pending' // Download pending.\nconst PLACEHOLDER_LOADING_CLASS = 'pcs-lazy-load-placeholder-loading' // Download started.\nconst PLACEHOLDER_ERROR_CLASS = 'pcs-lazy-load-placeholder-error' // Download failure.\nconst IMAGE_LOADING_CLASS = 'pcs-lazy-load-image-loading' // Download started.\nconst IMAGE_LOADED_CLASS = 'pcs-lazy-load-image-loaded' // Download completed.\n\nconst CLASSES = {\n  PLACEHOLDER_CLASS,\n  PLACEHOLDER_PENDING_CLASS,\n  PLACEHOLDER_LOADING_CLASS,\n  PLACEHOLDER_ERROR_CLASS,\n  IMAGE_LOADING_CLASS,\n  IMAGE_LOADED_CLASS\n}\n\n// Attributes copied from images to placeholders via data-* attributes for later restoration. The\n// image's classes and dimensions are also set on the placeholder.\n// The 3 data-* items are used by iOS.\nconst COPY_ATTRIBUTES = ['class', 'style', 'src', 'srcset', 'width', 'height', 'alt',\n  'usemap', 'data-file-width', 'data-file-height', 'data-image-gallery'\n]\n\n// Small images, especially icons, are quickly downloaded and may appear in many places. Lazily\n// loading these images degrades the experience with little gain. Always eagerly load these images.\n// Example: flags in the medal count for the \"1896 Summer Olympics medal table.\"\n// https://en.m.wikipedia.org/wiki/1896_Summer_Olympics_medal_table?oldid=773498394#Medal_count\nconst UNIT_TO_MINIMUM_LAZY_LOAD_SIZE: {[unit in string]?: number} = {\n  px: 50, // https://phabricator.wikimedia.org/diffusion/EMFR/browse/master/includes/MobileFormatter.php;c89f371ea9e789d7e1a827ddfec7c8028a549c12$22\n  ex: 10, // ''\n  em: 5 // 1ex  .5em; https://developer.mozilla.org/en-US/docs/Web/CSS/length#Units\n}\n\n/**\n * Replace an image with a placeholder.\n * @param {!Document} document\n * @param {!HTMLImageElement} image The image to be replaced.\n * @return {!HTMLSpanElement} The placeholder replacing image.\n */\nconst convertImageToPlaceholder = (document: Document, image: HTMLImageElement): HTMLSpanElement => {\n  // There are a number of possible implementations for placeholders including:\n  //\n  // - [MobileFrontend] Replace the original image with a span and replace the span with a new\n  //   downloaded image.\n  //   This option has a good fade-in but has some CSS concerns for the placeholder, particularly\n  //   `max-width`, and causes significant reflows when used with image widening.\n  //\n  // - [Previous] Replace the original image with a span and append a new downloaded image to the\n  //   span.\n  //   This option has the best cross-fading and extensibility but makes duplicating all the CSS\n  //   rules for the appended image impractical.\n  //\n  // - [Previous] Replace the original image's source with a transparent image and update the source\n  //   from a new downloaded image.\n  //   This option has a good fade-in and minimal CSS concerns for the placeholder and image but\n  //   causes significant reflows when used with image widening.\n  //\n  // - [Current] Replace the original image with a couple spans and replace the spans with a new\n  //   downloaded image.\n  //   This option is about the same as MobileFrontend but supports image widening without reflows.\n\n  // Create the root placeholder.\n  const placeholder = document.createElement('span')\n\n  // Copy the image's classes and append the placeholder and current state (pending) classes.\n  if (image.hasAttribute('class')) {\n    placeholder.setAttribute('class', image.getAttribute('class') || '')\n  }\n  placeholder.classList.add(PLACEHOLDER_CLASS)\n  placeholder.classList.add(PLACEHOLDER_PENDING_CLASS)\n\n  // Match the image's width, if specified. If image widening is used, this width will be overridden\n  // by !important priority.\n  const geometry = ElementGeometry.from(image)\n  if (geometry.width) { placeholder.style.setProperty('width', `${geometry.width}`) }\n\n  // Save the image's attributes to data-* attributes for later restoration.\n  ElementUtilities.copyAttributesToDataAttributes(image, placeholder, COPY_ATTRIBUTES)\n\n  // Create a spacer and match the aspect ratio of the original image, if determinable. If image\n  // widening is used, this spacer will scale with the width proportionally.\n  const spacing = document.createElement('span')\n  if (geometry.width && geometry.height) {\n    // Assume units are identical.\n    const ratio = geometry.heightValue / geometry.widthValue\n    spacing.style.setProperty('padding-top', `${ratio * 100}%`)\n  }\n\n  // Append the spacer to the placeholder and replace the image with the placeholder.\n  /* DOM sink status: safe - content transform with no user interference */\n  placeholder.appendChild(spacing)\n  /* DOM sink status: safe - content from parsoid output  */\n  if (image.parentNode) image.parentNode.replaceChild(placeholder, image)\n\n  return placeholder\n}\n\n/**\n * @param {!HTMLImageElement} image The image to be considered.\n * @return {!boolean} true if image download can be deferred, false if image should be eagerly\n *                    loaded.\n */\nconst isLazyLoadable = (image: HTMLImageElement): boolean => {\n  const geometry = ElementGeometry.from(image)\n  if (!geometry.width || !geometry.height) { return true }\n  const minWidth = UNIT_TO_MINIMUM_LAZY_LOAD_SIZE[geometry.widthUnit] || Infinity\n  const minHeight = UNIT_TO_MINIMUM_LAZY_LOAD_SIZE[geometry.heightUnit] || Infinity\n  return geometry.widthValue >= minWidth && geometry.heightValue >= minHeight\n}\n\n/**\n * @param {!Element} element\n * @return {!Array.<HTMLImageElement>} Convertible images descendent from but not including element.\n */\nconst queryLazyLoadableImages = (element: Element): HTMLImageElement[] =>\n  Polyfill.querySelectorAll(element, 'img').filter((image: HTMLImageElement) => isLazyLoadable(image))\n\n/**\n * Convert images with placeholders. The transformation is inverted by calling loadImage().\n * @param {!Document} document\n * @param {!Array.<HTMLImageElement>} images The images to lazily load.\n * @return {!Array.<HTMLSpanElement>} The placeholders replacing images.\n */\nconst convertImagesToPlaceholders = (document: Document, images: HTMLImageElement[]): HTMLSpanElement[] =>\n  images.map(image => convertImageToPlaceholder(document, image))\n\n/**\n * Start downloading image resources associated with a given placeholder and replace the placeholder\n * with a new image element when the download is complete.\n * @param {!Document} document\n * @param {!HTMLSpanElement} placeholder\n * @return {!HTMLImageElement} A new image element.\n */\nconst loadPlaceholder = (document: Document, placeholder: HTMLSpanElement): HTMLImageElement => {\n  placeholder.classList.add(PLACEHOLDER_LOADING_CLASS)\n  placeholder.classList.remove(PLACEHOLDER_PENDING_CLASS)\n\n  const image = document.createElement('img')\n\n  const retryListener = (event: MouseEvent) => { // eslint-disable-line require-jsdoc\n    image.setAttribute('src', image.getAttribute('src') || '')\n    event.stopPropagation()\n    event.preventDefault()\n  }\n\n  // Add the download listener prior to setting the src attribute to avoid missing the load event.\n  image.addEventListener('load', () => {\n    placeholder.removeEventListener('click', retryListener)\n    /* DOM sink status: safe - content from parsoid output */\n    if (placeholder.parentNode) placeholder.parentNode.replaceChild(image, placeholder)\n    image.classList.add(IMAGE_LOADED_CLASS)\n    image.classList.remove(IMAGE_LOADING_CLASS)\n  }, { once: true })\n\n  image.addEventListener('error', () => {\n    placeholder.classList.add(PLACEHOLDER_ERROR_CLASS)\n    placeholder.classList.remove(PLACEHOLDER_LOADING_CLASS)\n    placeholder.addEventListener('click', retryListener)\n  }, { once: true })\n\n  // Set src and other attributes, triggering a download.\n  ElementUtilities.copyDataAttributesToAttributes(placeholder, image, COPY_ATTRIBUTES)\n\n  // Append to the class list after copying over any preexisting classes.\n  image.classList.add(IMAGE_LOADING_CLASS)\n\n  return image\n}\n\nexport default {\n  CLASSES,\n  PLACEHOLDER_CLASS,\n  isLazyLoadable,\n  queryLazyLoadableImages,\n  convertImagesToPlaceholders,\n  convertImageToPlaceholder,\n  loadPlaceholder\n}","import Polyfill from './Polyfill'\n\n/**\n * Extracts array of page issues from element\n * @param {!Document} document\n * @return {!Array.<string>} Return empty array if nothing is extracted\n */\nconst collectPageIssueElements = document => {\n  if (!document) {\n    return []\n  }\n  return Polyfill.querySelectorAll(document, '.mbox-text-span').map(element => {\n    Polyfill.querySelectorAll(element, '.hide-when-compact, .collapsed').forEach(el => el.remove())\n    return element\n  })\n}\n\n/**\n * Returns section JSON for an element\n * @param {!Element} element\n * @return {!map} section info\n */\nconst sectionJSON = element => {\n  const section = element.closest('section[data-mw-section-id]')\n  const headerEl = section && section.querySelector('h1,h2,h3,h4,h5,h6')\n  return {\n    id: section && parseInt(section.getAttribute('data-mw-section-id'), 10),\n    /* DOM sink status: safe - content transform with no user interference */\n    title: headerEl && headerEl.innerHTML.trim(),\n    anchor: headerEl && headerEl.getAttribute('id')\n  }\n}\n\n/**\n * Extracts array of page issues from element\n * @param {!Document} document\n * @return {!Array.<Object>} Return empty array if nothing is extracted\n */\nconst collectPageIssues = document => collectPageIssueElements(document).map(el => ({\n  html: el.innerHTML.trim(),\n  section: sectionJSON(el)\n}))\n\n/**\n * Extracts array of hatnotes from an element\n * @param {?Element} element\n * @return {!Array.<Object>} Return empty array if nothing is extracted\n */\nconst collectHatnotes = element => {\n  if (!element) {\n    return []\n  }\n  return Polyfill.querySelectorAll(element, 'div.hatnote').map(element => {\n    const titles = Polyfill\n      .querySelectorAll(element, 'div.hatnote a[href]:not([href=\"\"]):not([redlink=\"1\"])')\n      .map(el => el.href)\n    return {\n      html: element.innerHTML.trim(),\n      links: titles,\n      section: sectionJSON(element)\n    }\n  })\n}\n\nexport default {\n  collectHatnotes,\n  collectPageIssues,\n  test: {\n    collectPageIssueElements\n  }\n}","// separate this out so it is only compiled once\nconst styleRegex = /(-?\\d*\\.?\\d*)(\\D+)?/\n\n/** CSS length value and unit of measure. */\nclass DimensionUnit {\n  /**\n   * Returns the dimension and units of an Element, usually width or height, as specified by inline\n   * style or attribute. This is a pragmatic not bulletproof implementation.\n   * @param {!Element} element\n   * @param {!string} property\n   * @return {?DimensionUnit}\n   */\n  static fromElement(element, property) {\n    return element.style.getPropertyValue(property)\n      && DimensionUnit.fromStyle(element.style.getPropertyValue(property))\n      || element.hasAttribute(property) && new DimensionUnit(element.getAttribute(property))\n      || undefined\n  }\n  /**\n   * This is a pragmatic not bulletproof implementation.\n   * @param {!string} property\n   * @return {!DimensionUnit}\n   */\n  static fromStyle(property) {\n    const matches = property.match(styleRegex) || []\n    return new DimensionUnit(matches[1], matches[2])\n  }\n\n  /**\n   * @param {!string} value\n   * @param {?string} unit Defaults to pixels.\n   */\n  constructor(value, unit) {\n    this._value = Number(value)\n    this._unit = unit || 'px'\n  }\n\n  /** @return {!number} NaN if unknown. */\n  get value() { return this._value }\n\n  /** @return {!string} */\n  get unit() { return this._unit }\n\n  /** @return {!string} */\n  toString() {\n    return isNaN(this.value) ? '' : `${this.value}${this.unit}`\n  }\n}\n\n/** Element width and height dimensions and units. */\nexport default class ElementGeometry {\n  /**\n   * @param {!Element} element\n   * @return {!ElementGeometry}\n   */\n  static from(element) {\n    return new ElementGeometry(DimensionUnit.fromElement(element, 'width'),\n      DimensionUnit.fromElement(element, 'height'))\n  }\n\n  /**\n   * @param {?DimensionUnit} width\n   * @param {?DimensionUnit} height\n   */\n  constructor(width, height) {\n    this._width = width\n    this._height = height\n  }\n\n  /**\n   * @return {?DimensionUnit}\n   */\n  get width() { return this._width }\n\n  /** @return {!number} NaN if unknown. */\n  get widthValue() { return this._width && !isNaN(this._width.value) ? this._width.value : NaN }\n\n  /** @return {!string} */\n  get widthUnit() { return this._width && this._width.unit || 'px' }\n\n  /**\n   * @return {?DimensionUnit}\n   */\n  get height() { return this._height }\n\n  /** @return {!number} NaN if unknown. */\n  get heightValue() { return this._height && !isNaN(this._height.value) ? this._height.value : NaN }\n\n  /** @return {!string} */\n  get heightUnit() { return this._height && this._height.unit || 'px' }\n}","/** Function rate limiter. */\nexport default class Throttle {\n  /**\n   * The function to invoke when not throttled.\n   *\n   * @callback NotThrottledFunction\n   */\n\n  /**\n   * A function wrapped in a Throttle.\n   *\n   * @callback WrappedFunction\n   */\n\n  /**\n   * Wraps a function in a Throttle.\n   * @param {!Window} window\n   * @param {!number} period The nonnegative minimum number of milliseconds between function\n   *                         invocations.\n   * @param {!NotThrottledFunction} funktion\n   * @return {!WrappedFunction}\n   */\n  static wrap(window, period, funktion) {\n    const throttle = new Throttle(window, period, funktion)\n    const throttled = function Throttled() { return throttle.queue(this, arguments) }\n    throttled.result = () => throttle.result\n    throttled.pending = () => throttle.pending()\n    throttled.delay = () => throttle.delay()\n    throttled.cancel = () => throttle.cancel()\n    throttled.reset = () => throttle.reset()\n    return throttled\n  }\n\n  /**\n   * @param {!Window} window\n   * @param {!number} period The nonnegative minimum number of milliseconds between function\n   *                         invocations.\n   * @param {!NotThrottledFunction} funktion\n   */\n  constructor(window, period, funktion) {\n    this._window = window\n    this._period = period\n    this._function = funktion\n\n    // The upcoming invocation's context and arguments.\n    this._context = undefined\n    this._arguments = undefined\n\n    // The previous invocation's result, timeout identifier, and last run timestamp.\n    this._result = undefined\n    this._timeout = 0\n    this._timestamp = 0\n  }\n\n  /**\n   * The return value of the initial run is always undefined. The return value of subsequent runs is\n   * always a previous result. The context and args used by a future invocation are always the most\n   * recently supplied. Invocations, even if immediately eligible, are dispatched.\n   * @param {?any} context\n   * @param {?any} args The arguments passed to the underlying function.\n   * @return {?any} The cached return value of the underlying function.\n   */\n  queue(context, args) {\n    // Always update the this and arguments to the latest supplied.\n    this._context = context\n    this._arguments = args\n\n    if (!this.pending()) {\n      // Queue a new invocation.\n      this._timeout = this._window.setTimeout(() => {\n        this._timeout = 0\n        this._timestamp = Date.now()\n        this._result = this._function.apply(this._context, this._arguments)\n      }, this.delay())\n    }\n\n    // Always return the previous result.\n    return this.result\n  }\n\n  /** @return {?any} The cached return value of the underlying function. */\n  get result() { return this._result }\n\n  /** @return {!boolean} true if an invocation is queued. */\n  pending() { return Boolean(this._timeout) }\n\n  /**\n   * @return {!number} The nonnegative number of milliseconds until an invocation is eligible to\n   *                   run.\n   */\n  delay() {\n    if (!this._timestamp) { return 0 }\n    return Math.max(0, this._period - (Date.now() - this._timestamp))\n  }\n\n  /**\n   * Clears any pending invocation but doesn't clear time last invoked or prior result.\n   * @return {void}\n   */\n  cancel() {\n    if (this._timeout) { this._window.clearTimeout(this._timeout) }\n    this._timeout = 0\n  }\n\n  /**\n   * Clears any pending invocation, time last invoked, and prior result.\n   * @return {void}\n   */\n  reset() {\n    this.cancel()\n    this._result = undefined\n    this._timestamp = 0\n  }\n}","const CLASS_PREFIX = 'pcs-platform-'\nconst CLASS = { ANDROID: `${CLASS_PREFIX}android`, IOS:  `${CLASS_PREFIX}ios` }\n\n// Regular expressions from https://phabricator.wikimedia.org/diffusion/EMFR/browse/master/resources/mobile.startup/browser.js;c89f371ea9e789d7e1a827ddfec7c8028a549c12.\n/**\n * @param {!Window} window\n * @return {!boolean} true if the user agent is Android, false otherwise.\n */\nconst isAndroid = window => /android/i.test(window.navigator.userAgent)\n\n/**\n * @param {!Window} window\n * @return {!boolean} true if the user agent is iOS, false otherwise.\n */\nconst isIOs = window => /ipad|iphone|ipod/i.test(window.navigator.userAgent)\n\n/**\n * @param {!HTMLDocument} document\n * @param {!string} platform one of the values in CLASS\n * @return {void}\n */\nconst setPlatform = (document, platform) => {\n  document.documentElement.classList.add(platform)\n}\n\n/**\n * @param {!Window} window\n * @return {void}\n */\nconst classify = window => {\n  const html = window.document.documentElement\n  if (isAndroid(window)) { html.classList.add(CLASS.ANDROID) }\n  if (isIOs(window)) { html.classList.add(CLASS.IOS) }\n}\n\nexport default {\n  CLASS,\n  CLASS_PREFIX,\n  classify,\n  setPlatform\n}","import './ThemeTransform.css'\n\nconst CLASS_PREFIX = 'pcs-theme-'\n// Theme to CSS classes.\nconst THEME = {\n  DEFAULT: `${CLASS_PREFIX}default`,\n  DARK: `${CLASS_PREFIX}dark`,\n  SEPIA: `${CLASS_PREFIX}sepia`,\n  BLACK: `${CLASS_PREFIX}black`\n}\n\n\n/**\n * @param {?Element} el element\n * @param {!string} theme\n * @return {void}\n */\nconst setThemeOnElement = (el, theme) => {\n  if (!el) {\n    return\n  }\n  // Set the new theme.\n  el.classList.add(theme)\n\n  // Clear any previous theme.\n  for (const key in THEME) {\n    if (Object.prototype.hasOwnProperty.call(THEME, key) && THEME[key] !== theme) {\n      el.classList.remove(THEME[key])\n    }\n  }\n}\n\n/**\n * @param {!Document} document\n * @param {!string} theme\n * @return {void}\n */\nconst setTheme = (document, theme) => {\n  const body = document.body\n  setThemeOnElement(body, theme)\n  // the pcs element is necessary to allow\n  // template editors to theme templates by\n  // declaring styles for .themeclass .templateclass {\n  // TemplateStyles are scoped to .mw-parser-outpt by parsoid\n  // so without an intermediate div with the theme class,\n  // the styles aren't applied\n  const pcs = document.getElementById('pcs')\n  setThemeOnElement(pcs, theme)\n}\n\nexport default {\n  THEME,\n  CLASS_PREFIX,\n  setTheme\n}","import './FooterContainer.css'\n\n/**\n * Returns a fragment containing structural footer html which may be inserted where needed.\n * @param {!Document} document\n * @return {!DocumentFragment}\n */\nconst containerFragment = document => {\n  const containerFragment = document.createDocumentFragment()\n  const menuSection = document.createElement('section')\n  menuSection.id = 'pcs-footer-container-menu'\n  menuSection.className = 'pcs-footer-section'\n  menuSection.innerHTML =\n  `<h2 id='pcs-footer-container-menu-heading'></h2>\n   <div id='pcs-footer-container-menu-items'></div>`\n  /* DOM sink status: risk? */\n  containerFragment.appendChild(menuSection)\n  const readMoreSection = document.createElement('section')\n  readMoreSection.id = 'pcs-footer-container-readmore'\n  readMoreSection.className = 'pcs-footer-section'\n  readMoreSection.style.display = 'none'\n  readMoreSection.innerHTML =\n  `<h2 id='pcs-footer-container-readmore-heading'></h2>\n   <div id='pcs-footer-container-readmore-pages'></div>`\n  /* DOM sink status: risk? */\n  containerFragment.appendChild(readMoreSection)\n  const legalSection = document.createElement('section')\n  legalSection.id = 'pcs-footer-container-legal'\n  /* DOM sink status: risk? */\n  containerFragment.appendChild(legalSection)\n  return containerFragment\n}\n\n/**\n * Indicates whether container is has already been added.\n * @param {!Document} document\n * @return {boolean}\n */\nconst isContainerAttached = document => Boolean(document.querySelector('#pcs-footer-container'))\n\nexport default {\n  containerFragment,\n  isContainerAttached // todo: rename isAttached()?\n}","import './FooterLegal.css'\n\n/**\n * @typedef {function} FooterLegalClickCallback\n * @return {void}\n */\n\n/**\n  * @typedef {function} FooterBrowserClickCallback\n  * @return {void}\n  */\n\n/**\n * @param {!string} licenseString\n * @param {?string} linkText\n * @return {!string}\n */\nconst buildLicenseHtml = (licenseString, linkText) => {\n  const halves = licenseString.split('$1')\n  return `${halves[0]}<a class='pcs-footer-legal-license-link'>${linkText}</a>${halves[1]}`\n}\n\n/**\n * Adds legal footer html to 'containerID' element.\n * @param {!Element} content\n * @param {?string} licenseString\n * @param {?string} licenseSubstitutionString\n * @param {!string} containerID\n * @param {!FooterLegalClickCallback} licenseLinkClickHandler\n * @param {!string} viewInBrowserString\n * @param {!FooterBrowserClickCallback} browserLinkClickHandler\n * @return {void}\n */\nconst add = (content, licenseString, licenseSubstitutionString, containerID,\n  licenseLinkClickHandler, viewInBrowserString, browserLinkClickHandler) => {\n\n  // todo: don't manipulate the selector. The client can make this an ID if they want it to be.\n  const container = content.querySelector(`#${containerID}`)\n\n  /* DOM sink status: risk? - content can be changed by clients */\n  container.innerHTML =\n  `<div class='pcs-footer-legal-contents'>\n    <hr class='pcs-footer-legal-divider'>\n    <span class='pcs-footer-legal-license'>\n    ${buildLicenseHtml(licenseString, licenseSubstitutionString)}\n    <br>\n      <div class=\"pcs-footer-browser\">\n        <a class='pcs-footer-browser-link'>\n          ${viewInBrowserString}\n        </a>\n      </div>\n    </span>\n  </div>`\n\n  container.querySelector('.pcs-footer-legal-license-link')\n    .addEventListener('click', () => {\n      licenseLinkClickHandler()\n    })\n\n  container.querySelector('.pcs-footer-browser-link')\n    .addEventListener('click', () => {\n      browserLinkClickHandler()\n    })\n}\n\nexport default {\n  add\n}","import './FooterMenu.css'\nimport CollectionUtilities from './CollectionUtilities'\n\n/**\n * @typedef {function} FooterMenuItemClickCallback\n * @param {!Array.<string>} payload Important - should return empty array if no payload strings.\n * @return {void}\n */\n\n/**\n * @typedef {string} MenuItemType\n */\n\n/**\n * Type representing kinds of menu items.\n * IMPORTANT: Don't change these values without considering it a breaking change.\n * Existing clients rely on using the string values so that they are serializable.\n * @enum {MenuItemType}\n */\nconst MenuItemType = {\n  languages: 'languages',\n  lastEdited: 'lastEdited',\n  pageIssues: 'pageIssues',\n  disambiguation: 'disambiguation',\n  coordinate: 'coordinate',\n  talkPage: 'talkPage'\n}\n\n/**\n * Menu item model.\n */\nclass MenuItem {\n  /**\n   * MenuItem constructor.\n   * @param {!string} title\n   * @param {?string} subtitle\n   * @param {!MenuItemType} itemType\n   * @param {FooterMenuItemClickCallback} clickHandler\n   */\n  constructor(title, subtitle, itemType, clickHandler) {\n    this.title = title\n    this.subtitle = subtitle\n    this.itemType = itemType\n    this.clickHandler = clickHandler\n    this.payload = []\n  }\n\n  /**\n   * Returns icon CSS class for this menu item based on its type.\n   * @return {!string}\n   */\n  iconClass() {\n    switch (this.itemType) {\n    case MenuItemType.languages:\n      return 'pcs-footer-menu-icon-languages'\n    case MenuItemType.lastEdited:\n      return 'pcs-footer-menu-icon-last-edited'\n    case MenuItemType.talkPage:\n      return 'pcs-footer-menu-icon-talk-page'\n    case MenuItemType.pageIssues:\n      return 'pcs-footer-menu-icon-page-issues'\n    case MenuItemType.disambiguation:\n      return 'pcs-footer-menu-icon-disambiguation'\n    case MenuItemType.coordinate:\n      return 'pcs-footer-menu-icon-coordinate'\n    default:\n      return ''\n    }\n  }\n\n  /**\n   * Extracts array of page issues, disambiguation titles, etc from element.\n   * @typedef {function} PayloadExtractor\n   * @param {!Document} document\n   * @param {?Element} element\n   * @return {!Array.<string>} Return empty array if nothing is extracted\n   */\n\n  /**\n   * Returns reference to function for extracting payload when this menu item is tapped.\n   * @return {?PayloadExtractor}\n   */\n  payloadExtractor() {\n    switch (this.itemType) {\n    case MenuItemType.pageIssues:\n      return CollectionUtilities.collectPageIssues\n    case MenuItemType.disambiguation:\n      return CollectionUtilities.collectHatnotes\n    default:\n      return undefined\n    }\n  }\n}\n\n/**\n * Makes document fragment for a menu item.\n * @param {!MenuItem} menuItem\n * @param {!Document} document\n * @return {!DocumentFragment}\n */\nconst documentFragmentForMenuItem = (menuItem, document) => {\n  const item = document.createElement('div')\n  item.className = 'pcs-footer-menu-item'\n  item.role = 'menuitem'\n  const containerAnchor = document.createElement('a')\n  containerAnchor.addEventListener('click', () => {\n    menuItem.clickHandler(menuItem.payload)\n  })\n\n  item.appendChild(containerAnchor)\n\n  if (menuItem.title) {\n    const title = document.createElement('div')\n    title.className = 'pcs-footer-menu-item-title'\n    /* DOM sink status: risk? - headingString can be changed by clients */\n    title.innerText = menuItem.title\n    containerAnchor.title = menuItem.title\n    containerAnchor.appendChild(title)\n  }\n\n  if (menuItem.subtitle) {\n    const subtitle = document.createElement('div')\n    subtitle.className = 'pcs-footer-menu-item-subtitle'\n    /* DOM sink status: risk? - headingString can be changed by clients */\n    subtitle.innerText = menuItem.subtitle\n    containerAnchor.appendChild(subtitle)\n  }\n\n  const iconClass = menuItem.iconClass()\n  if (iconClass) {\n    item.classList.add(iconClass)\n  }\n\n  return document.createDocumentFragment().appendChild(item)\n}\n\n/**\n * Adds a MenuItem to a container.\n * @param {!MenuItem} menuItem\n * @param {!string} containerID\n * @param {!Document} document\n * @return {void}\n */\nconst addItem = (menuItem, containerID, document) => {\n  document.getElementById(containerID).appendChild(\n    documentFragmentForMenuItem(menuItem, document)\n  )\n}\n\n/**\n * Conditionally adds a MenuItem to a container.\n * @param {!string} title\n * @param {!string} subtitle\n * @param {!MenuItemType} itemType\n * @param {!string} containerID\n * @param {FooterMenuItemClickCallback} clickHandler\n * @param {!Document} document\n * @return {void}\n */\nconst maybeAddItem = (title, subtitle, itemType, containerID, clickHandler, document) => {\n  if (title === '') {\n    return\n  }\n  const item = new MenuItem(title, subtitle, itemType, clickHandler)\n\n  // Items are not added if they have a payload extractor which fails to extract anything.\n  const extractor = item.payloadExtractor()\n  if (extractor) {\n    item.payload = extractor(document)\n    if (item.payload.length === 0) {\n      return\n    }\n  }\n\n  addItem(item, containerID, document)\n}\n\n/**\n * Sets heading element string.\n * @param {!string} headingString\n * @param {!string} headingID\n * @param {!Document} document\n * @return {void}\n */\nconst setHeading = (headingString, headingID, document) => {\n  const headingElement = document.getElementById(headingID)\n  /* DOM sink status: risk? - headingString can be changed by clients */\n  headingElement.innerText = headingString\n  headingElement.title = headingString\n}\n\nexport default {\n  MenuItemType, // todo: rename to just ItemType?\n  setHeading,\n  maybeAddItem\n}","import './FooterReadMore.css'\n\n/**\n * @typedef {function} TitlesShownHandler\n * @param {!Array.<string>} titles\n * @return {void}\n */\n\n/**\n * Display fetched read more pages.\n * @typedef {function} ShowReadMorePagesHandler\n * @param {!Array.<object>} pages\n * @param {!string} heading\n * @param {!string} sectionContainerId\n * @param {!string} pageContainerId\n * @param {!TitlesShownHandler} titlesShownHandler\n * @param {!Document} document\n * @return {void}\n */\n\n/**\n * Removes parenthetical enclosures from string.\n * @param {!string} string\n * @param {!string} opener\n * @param {!string} closer\n * @return {!string}\n */\nconst safelyRemoveEnclosures = (string, opener, closer) => {\n  const enclosureRegex = new RegExp(`\\\\s?[${opener}][^${opener}${closer}]+[${closer}]`, 'g')\n  let counter = 0\n  const safeMaxTries = 30\n  let stringToClean = string\n  let previousString = ''\n  do {\n    previousString = stringToClean\n    stringToClean = stringToClean.replace(enclosureRegex, '')\n    counter++\n  } while (previousString !== stringToClean && counter < safeMaxTries)\n  return stringToClean\n}\n\n/**\n * Removes '(...)' and '/.../' parenthetical enclosures from string.\n * @param {!string} string\n * @return {!string}\n */\nconst cleanExtract = string => {\n  let stringToClean = string\n  stringToClean = safelyRemoveEnclosures(stringToClean, '(', ')')\n  stringToClean = safelyRemoveEnclosures(stringToClean, '/', '/')\n  return stringToClean\n}\n\n/**\n * Read more page model.\n */\nclass ReadMorePage {\n  /**\n   * ReadMorePage constructor.\n   * @param {!string} title\n   * @param {!string} displayTitle\n   * @param {?string} thumbnail\n   * @param {?string} description\n   * @param {?string} extract\n   */\n  constructor(title, displayTitle, thumbnail, description, extract) {\n    this.title = title\n    this.displayTitle = displayTitle\n    this.thumbnail = thumbnail\n    this.description = description\n    this.extract = extract\n  }\n}\n\n/**\n * Makes document fragment for a read more page.\n * @param {!ReadMorePage} readMorePage\n * @param {!number} index\n * @param {!Document} document\n * @return {!DocumentFragment}\n */\nconst documentFragmentForReadMorePage = (readMorePage, index, document) => {\n  const outerAnchorContainer = document.createElement('a')\n  outerAnchorContainer.id = index\n  outerAnchorContainer.className = 'pcs-footer-readmore-page'\n\n  const hasImage = readMorePage.thumbnail && readMorePage.thumbnail.source\n  if (hasImage) {\n    const image = document.createElement('div')\n    image.style.backgroundImage = `url(${readMorePage.thumbnail.source})`\n    image.classList.add('pcs-footer-readmore-page-image')\n    outerAnchorContainer.appendChild(image)\n  }\n\n  const innerDivContainer = document.createElement('div')\n  innerDivContainer.classList.add('pcs-footer-readmore-page-container')\n  outerAnchorContainer.appendChild(innerDivContainer)\n  outerAnchorContainer.setAttribute('title', readMorePage.title)\n  outerAnchorContainer.setAttribute('data-pcs-source', 'read-more')\n  outerAnchorContainer.href = `./${encodeURI(readMorePage.title)}`\n\n  let titleToShow\n  if (readMorePage.displayTitle) {\n    titleToShow = readMorePage.displayTitle\n  } else if (readMorePage.title) {\n    titleToShow = readMorePage.title\n  }\n\n  if (titleToShow) {\n    const title = document.createElement('div')\n    title.id = index\n    title.className = 'pcs-footer-readmore-page-title'\n    /* DOM sink status: safe - content transform with no user interference */\n    title.innerHTML = titleToShow.replace(/_/g, ' ')\n    outerAnchorContainer.title = readMorePage.title.replace(/_/g, ' ')\n    innerDivContainer.appendChild(title)\n  }\n\n  let description\n  if (readMorePage.description) {\n    description = readMorePage.description\n  }\n  if ((!description || description.length < 10) && readMorePage.extract) {\n    description = cleanExtract(readMorePage.extract)\n  }\n  if (description) {\n    const descriptionEl = document.createElement('div')\n    descriptionEl.id = index\n    descriptionEl.className = 'pcs-footer-readmore-page-description'\n    /* DOM sink status: safe - content from read more query endpoint */\n    descriptionEl.innerHTML = description\n    innerDivContainer.appendChild(descriptionEl)\n  }\n\n  return document.createDocumentFragment().appendChild(outerAnchorContainer)\n}\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * @type {ShowReadMorePagesHandler}\n */\nconst showReadMorePages = (pages, heading, sectionContainerId, pageContainerId, titlesShownHandler,\n  document) => {\n  const shownTitles = []\n  const sectionContainer = document.getElementById(sectionContainerId)\n  const pageContainer = document.getElementById(pageContainerId)\n  setHeading(\n    heading,\n    'pcs-footer-container-readmore-heading',\n    document\n  )\n  pages.forEach((page, index) => {\n    const title = page.titles.normalized\n    shownTitles.push(title)\n    const pageModel = new ReadMorePage(title, page.titles.display, page.thumbnail,\n      page.description, page.extract)\n    const pageFragment = documentFragmentForReadMorePage(pageModel, index, document)\n    pageContainer.appendChild(pageFragment)\n  })\n  titlesShownHandler(shownTitles)\n  sectionContainer.style.display = 'block'\n}\n\n/**\n * URL for retrieving 'Read more' pages for a given title.\n * Leave 'baseURL' null if you don't need to deal with proxying.\n * @param {!string} title\n * @param {!number} count Number of `Read more` items to fetch for this title\n * @param {?string} baseURL\n * @return {!string}\n */\nconst readMoreQueryURL = (title, count, baseURL) =>\n  `${baseURL || ''}/page/related/${title}`\n\n/**\n * Fetches 'Read more' pages and adds them if found.\n * @param {!string} title\n * @param {!string} heading\n * @param {!number} count\n * @param {!string} sectionContainerId\n * @param {!string} pageContainerId\n * @param {?string} baseURL\n * @param {!TitlesShownHandler} titlesShownHandler\n * @param {!Document} document\n * @return {void}\n */\nconst fetchAndAdd = (title, heading, count, sectionContainerId, pageContainerId, baseURL,\n  titlesShownHandler, document) => {\n  const xhr = new XMLHttpRequest() // eslint-disable-line no-undef\n  xhr.open('GET', readMoreQueryURL(title, count, baseURL), true)\n  xhr.onload = () => {\n    let pages\n    try {\n      pages = JSON.parse(xhr.responseText).pages\n    } catch (e) { }\n    if (!(pages && pages.length)) {\n      return\n    }\n    let results\n    if (pages.length > count) {\n      const rand = Math.floor(Math.random() * Math.floor(pages.length - count))\n      results = pages.slice(rand, rand + count)\n    } else {\n      results = pages\n    }\n    showReadMorePages(\n      results,\n      heading,\n      sectionContainerId,\n      pageContainerId,\n      titlesShownHandler,\n      document\n    )\n  }\n  xhr.send()\n}\n\n/**\n * Sets heading element string.\n * @param {!string} headingString\n * @param {!string} headingID\n * @param {!Document} document\n * @return {void}\n */\nconst setHeading = (headingString, headingID, document) => {\n  const headingElement = document.getElementById(headingID)\n  /* DOM sink status: risk? - headingString can be changed by clients */\n  headingElement.innerText = headingString\n  headingElement.title = headingString\n}\n\nexport default {\n  fetchAndAdd,\n  setHeading,\n  test: {\n    cleanExtract,\n    safelyRemoveEnclosures\n  }\n}","import ElementUtilities from './ElementUtilities'\nimport NodeUtilities from './NodeUtilities'\nimport Polyfill from './Polyfill'\n\nconst REFERENCE_SELECTOR = '.reference, .mw-ref'\nconst CITE_FRAGMENT_PREFIX = '#cite_note-'\nconst BACK_LINK_FRAGMENT_PREFIX = '#pcs-ref-back-link-'\nconst BACK_LINK_ATTRIBUTE = 'pcs-back-links'\n\nconst CLASS = {\n  BACK_LINK_ANCHOR: 'pcs-ref-back-link',\n  BACK_LINK_CONTAINER: 'pcs-ref-backlink-container',\n  BODY: 'pcs-ref-body',\n  BODY_HEADER: 'pcs-ref-body-header',\n  BODY_CONTENT: 'pcs-ref-body-content',\n  REF: 'pcs-ref'\n}\n\n\n/**\n * Does this have the proper fragment prefix?\n * @param {!string} href\n * @param {!string} fragmentPrefix fragment prefix to look for\n * @param {?string} pageTitle assumed to be encoded for links\n * @return {!boolean}\n */\nconst hasFragmentPrefix = (href, fragmentPrefix, pageTitle) => {\n  const decodedHref = decodeURIComponent(href)\n  const decodedFragment = decodeURIComponent(fragmentPrefix)\n  if (pageTitle !== undefined) {\n    const decodedPageTitle = decodeURIComponent(pageTitle)\n    const relativePath = `./${decodedPageTitle}`\n    return decodedHref.indexOf(relativePath) === 0 && href.indexOf(decodedFragment) === relativePath.length\n  }\n  return decodedHref.indexOf(decodedFragment) > -1\n\n}\n\n/**\n * Is Citation.\n * @param {!string} href\n * @param {!string} pageTitle - assumed to be encoded for links\n * @return {!boolean}\n */\nconst isCitation = (href, pageTitle) => hasFragmentPrefix(href, CITE_FRAGMENT_PREFIX, pageTitle)\n\n/**\n * Is Back Link.\n * @param {!string} href\n * @param {!string} pageTitle - assumed to be encoded for links\n * @return {!boolean}\n */\nconst isBackLink = (href, pageTitle) => hasFragmentPrefix(href, BACK_LINK_FRAGMENT_PREFIX, pageTitle)\n\n\n/**\n * Determines if node is a text node containing only whitespace.\n * @param {!Node} node\n * @return {!boolean}\n */\nconst isWhitespaceTextNode = node =>\n  Boolean(node) && node.nodeType === Node.TEXT_NODE && Boolean(node.textContent.match(/^\\s+$/))\n\n/**\n * Checks if element has a child anchor with a citation link.\n * @param {!Element} element\n * @return {!boolean}\n */\nconst hasCitationLink = element => {\n  const anchor = element.querySelector('a')\n  return anchor && isCitation(anchor.hash)\n}\n\n/**\n * Get the reference text container.\n * @param {!Document} document\n * @param {!Element} source\n * @return {?HTMLElement}\n */\nconst getRefTextContainer = (document, source) => {\n  const refTextContainerID = source.querySelector('A').getAttribute('href').split('#')[1]\n  const refTextContainer = document.getElementById(refTextContainerID)\n    || document.getElementById(decodeURIComponent(refTextContainerID))\n\n  return refTextContainer\n}\n\n/**\n * Extract reference text free of backlinks.\n * @param {!Document} document\n * @param {!Element} source\n * @return {!string}\n */\nconst collectRefText = (document, source) => {\n  const refTextContainer = getRefTextContainer(document, source)\n  if (!refTextContainer) {\n    return ''\n  }\n  const refTextSpan = refTextContainer.querySelector('span.mw-reference-text')\n  if (!refTextSpan) {\n    return ''\n  }\n  return refTextSpan.innerHTML.trim()\n}\n\n/**\n * Get closest element to node which has class `reference`. If node itself has class `reference`\n * returns the node.\n * @param {!Node} sourceNode\n * @return {?HTMLElement}\n */\nconst closestReferenceClassElement = sourceNode => {\n  if (Polyfill.matchesSelector(sourceNode, REFERENCE_SELECTOR)) {\n    return sourceNode\n  }\n  return ElementUtilities.findClosestAncestor(sourceNode, REFERENCE_SELECTOR)\n}\n\n/**\n * Reference item model.\n */\nclass ReferenceItem {\n  /**\n   * ReferenceItem constructor.\n   * @param {!string} id\n   * @param {!DOMRect} rect\n   * @param {?string} text\n   * @param {?string} html\n   * @param {?string} href\n   */\n  constructor(id, rect, text, html, href) {\n    this.id = id\n    this.rect = rect\n    this.text = text\n    this.html = html\n    this.href = href\n  }\n}\n\n/**\n * Reference item model.\n */\nclass ReferenceLinkItem {\n  /**\n   * ReferenceLinkItem construtor.\n   * @param {!string} href\n   * @param {?string} text\n   */\n  constructor(href, text) {\n    this.href = href\n    this.text = text\n  }\n}\n\n/**\n * Converts node to ReferenceItem.\n * @param {!Document} document\n * @param {!Node} node\n * @return {!ReferenceItem}\n */\nconst referenceItemForNode = (document, node) => new ReferenceItem(\n  closestReferenceClassElement(node).id,\n  NodeUtilities.getBoundingClientRectAsPlainObject(node),\n  node.textContent,\n  collectRefText(document, node),\n  node.querySelector('A').getAttribute('href')\n)\n\n/**\n * Converts node to ReferenceLinkItem.\n * @param {!Document} document\n * @param {!Node} node\n * @return {!ReferenceItem}\n */\nconst referenceLinkItemForNode = (document, node) => new ReferenceLinkItem(\n  node.querySelector('A').getAttribute('href'),\n  node.textContent\n)\n\n/**\n * Container for nearby references including the index of the selected reference.\n */\nclass NearbyReferences {\n/**\n * @param {!number} selectedIndex\n * @param {!Array.<ReferenceItem>} referencesGroup\n * @return {!NearbyReferences}\n */\n  constructor(selectedIndex, referencesGroup) {\n    this.selectedIndex = selectedIndex\n    this.referencesGroup = referencesGroup\n  }\n}\n\n/**\n * Closure around a node for getting previous or next sibling.\n *\n * @typedef SiblingGetter\n * @param {!Node} node\n * @return {?Node}\n */\n\n/**\n  * Closure around `collectedNodes` for collecting reference nodes.\n  *\n  * @typedef Collector\n  * @param {!Node} node\n  * @return {void}\n  */\n\n/**\n * Get adjacent non-whitespace node.\n * @param {!Node} node\n * @param {!SiblingGetter} siblingGetter\n * @return {?Node}\n */\nconst adjacentNonWhitespaceNode = (node, siblingGetter) => {\n  let currentNode = node\n  do {\n    currentNode = siblingGetter(currentNode)\n  } while (isWhitespaceTextNode(currentNode))\n  return currentNode\n}\n\n/**\n * Collect adjacent reference nodes. The starting node is not collected.\n * @param {!Node} node\n * @param {!SiblingGetter} siblingGetter\n * @param {!Collector} nodeCollector\n * @return {void}\n */\nconst collectAdjacentReferenceNodes = (node, siblingGetter, nodeCollector) => {\n  let currentNode = node\n  while (true) {\n    currentNode = adjacentNonWhitespaceNode(currentNode, siblingGetter)\n    if (!currentNode || currentNode.nodeType !== Node.ELEMENT_NODE\n        || !hasCitationLink(currentNode)) {\n      break\n    }\n    nodeCollector(currentNode)\n  }\n}\n\n/* eslint-disable valid-jsdoc */\n/** @type {SiblingGetter} */\nconst prevSiblingGetter = node => node.previousSibling\n\n/** @type {SiblingGetter} */\nconst nextSiblingGetter = node => node.nextSibling\n/* eslint-enable valid-jsdoc */\n\n/**\n * Collect nearby reference nodes.\n * @param {!Node} sourceNode\n * @return {!Array.<Node>}\n */\nconst collectNearbyReferenceNodes = sourceNode => {\n  const collectedNodes = [sourceNode]\n\n  /* eslint-disable require-jsdoc */\n  // These are `Collector`s.\n  const collectedNodesUnshifter = node => collectedNodes.unshift(node)\n  const collectedNodesPusher = node => collectedNodes.push(node)\n  /* eslint-enable require-jsdoc */\n\n  collectAdjacentReferenceNodes(sourceNode, prevSiblingGetter, collectedNodesUnshifter)\n  collectAdjacentReferenceNodes(sourceNode, nextSiblingGetter, collectedNodesPusher)\n\n  return collectedNodes\n}\n\n/**\n * Reads the BACK_LINK_ATTRIBUTE and returns a list of back link hrefs\n * @param {Element} element to read the back links from\n * @return {Array.<string>} hrefs of the back links\n */\nconst getBackLinks = element => {\n  const backLinksJSON = element.getAttribute(BACK_LINK_ATTRIBUTE)\n  if (!backLinksJSON) {\n    return []\n  }\n  return JSON.parse(backLinksJSON)\n}\n\n/**\n * Collect nearby reference nodes.\n * @param {!Document} document\n * @param {!Element} target\n * @param {!string} href\n * @return {!{referenceId, referenceText, backLinks, href}}\n */\nconst collectReferencesForBackLink = (document, target, href) => {\n  const backLinkHrefs = getBackLinks(target)\n  if (!backLinkHrefs || backLinkHrefs.length === 0) {\n    return {}\n  }\n  const referenceId = href.split(BACK_LINK_FRAGMENT_PREFIX)[1]\n  let referenceText\n  const backLinks = []\n  // Used as fallback. Send the href of the first back link as the event href\n  const firstBackLinkHref = backLinkHrefs[0]\n  for (let i = 0; i < backLinkHrefs.length; i++) {\n    const backLinkHref = backLinkHrefs[i]\n    const id = backLinkHref.split('#')[1]\n    const element = document.getElementById(id)\n    if (!element) {\n      continue\n    }\n    if (!referenceText) {\n      referenceText = element.textContent.trim()\n    }\n    // Use an object with id to allow for adding more properties in the future\n    backLinks.push({ id })\n  }\n  return { referenceId, referenceText, backLinks, href: firstBackLinkHref }\n}\n\n\n/**\n * Collect nearby references.\n * @param {!Document} document\n * @param {!Node} referenceElement\n * @return {!NearbyReferences}\n */\nconst collectNearbyReferenceForReferenceElement = (document, referenceElement) => {\n  const referenceNodes = collectNearbyReferenceNodes(referenceElement)\n  const selectedIndex = referenceNodes.indexOf(referenceElement)\n  const referencesGroup = referenceNodes.map(node => referenceItemForNode(document, node))\n  return new NearbyReferences(selectedIndex, referencesGroup)\n}\n\n/**\n * Collect nearby references.\n * @param {!Document} document\n * @param {!Node} sourceNode\n * @return {!NearbyReferences}\n */\nconst collectNearbyReferences = (document, sourceNode) => {\n  const sourceNodeParent = sourceNode.parentElement // reference is the parent of the <a> tag\n  return collectNearbyReferenceForReferenceElement(document, sourceNodeParent)\n}\n\n/**\n * Collect nearby references.\n * @param {!Document} document\n * @param {!Node} sourceNode\n * @return {!NearbyReferences}\n */\nconst collectNearbyReferencesAsText = (document, sourceNode) => {\n  const sourceNodeParent = sourceNode.parentElement\n  const referenceNodes = collectNearbyReferenceNodes(sourceNodeParent)\n  const selectedIndex = referenceNodes.indexOf(sourceNodeParent)\n  const referencesGroup = referenceNodes.map(node => referenceLinkItemForNode(document, node))\n  return new NearbyReferences(selectedIndex, referencesGroup)\n}\n\nexport default {\n  collectNearbyReferences,\n  collectNearbyReferencesAsText,\n  collectReferencesForBackLink,\n  isBackLink,\n  isCitation,\n  CLASS,\n  BACK_LINK_FRAGMENT_PREFIX,\n  BACK_LINK_ATTRIBUTE,\n  test: {\n    adjacentNonWhitespaceNode,\n    closestReferenceClassElement,\n    collectAdjacentReferenceNodes,\n    collectNearbyReferenceNodes,\n    collectRefText,\n    getRefTextContainer,\n    hasCitationLink,\n    isWhitespaceTextNode,\n    nextSiblingGetter,\n    prevSiblingGetter\n  }\n}","/**\n * Sets text size adjustment percentage of the body element\n * @param  {!HTMLBodyElement} body that needs the margins adjusted.\n * @param  {!string} textSize percentage for text-size-adjust in format of string, like '100%'\n * @return {void}\n */\nconst setPercentage = (body: HTMLBodyElement, textSize: string): void => {\n    if (textSize){\n        // casting body style to avoid errors with the subscript operator and typescript\n        // see https://stackoverflow.com/questions/37655393\n        (<any>body.style)['-webkit-text-size-adjust'] = textSize;\n        (<any>body.style)['text-size-adjust'] = textSize;\n    }\n}\n\n\nexport default {\n    setPercentage\n}","interface Spacing {\n  top?: string\n  right?: string\n  bottom?: string\n  left?: string\n}\n\n/**\n * Sets the margins on an element via inline styles.\n * @param {!HTMLBodyElement} bodyElement the element that needs the margins adjusted.\n *   For the apps this is usually the body element.\n * @param {Spacing} values { top, right, bottom, left }\n *   Use value strings with units, e.g. '16px'. Undefined values are ignored.\n * @return {void}\n */\nconst setMargins = (bodyElement: HTMLBodyElement, values: Spacing): void => {\n  if (values.top !== undefined) {\n    bodyElement.style.marginTop = values.top\n  }\n  if (values.right !== undefined) {\n    bodyElement.style.marginRight = values.right\n  }\n  if (values.bottom !== undefined) {\n    bodyElement.style.marginBottom = values.bottom\n  }\n  if (values.left !== undefined) {\n    bodyElement.style.marginLeft = values.left\n  }\n}\n\n/**\n * Sets padding on an element via inline styles.\n * @param {!HTMLBodyElement} bodyElement the element that needs the padding adjusted.\n *   For the apps this is usually the body element.\n * @param {Spacing} values { top, right, bottom, left }\n *   Use value strings with units, e.g. '16px'. Undefined values are ignored.\n * @return {void}\n */\nconst setPadding = (bodyElement: HTMLBodyElement, values: Spacing): void => {\n  if (values.top !== undefined) {\n    bodyElement.style.paddingTop = values.top\n  }\n  if (values.right !== undefined) {\n    bodyElement.style.paddingRight = values.right\n  }\n  if (values.bottom !== undefined) {\n    bodyElement.style.paddingBottom = values.bottom\n  }\n  if (values.left !== undefined) {\n    bodyElement.style.paddingLeft = values.left\n  }\n}\n\nexport default {\n  setMargins,\n  setPadding\n}","import './DimImagesTransform.css'\nconst CLASS = 'pcs-dim-images'\n\n/**\n * @param {!Document} document\n * @param {!boolean} enable\n * @return {void}\n */\nconst dimImages = (document, enable) => {\n  document.body.classList[enable ? 'add' : 'remove'](CLASS)\n}\n\n/**\n * @deprecated Use dimImages instead, which only requires a Document\n * @param {!Window} window\n * @param {!boolean} enable\n * @return {void}\n */\nconst dim = (window, enable) => dimImages(window.document, enable)\n\n/**\n * @param {!Document} document\n * @return {boolean}\n */\nconst areImagesDimmed = document => document.body.classList.contains(CLASS)\n\n/**\n * @deprecated Use areImagesDimmed instead, which only requires a Document\n * @param {!Window} window\n * @return {boolean}\n */\nconst isDim = window => areImagesDimmed(window.document)\n\nexport default {\n  CLASS,\n  dim,\n  isDim,\n  dimImages,\n  areImagesDimmed,\n}","import CollapseTable from './CollapseTable'\nimport ElementUtilities from './ElementUtilities'\nimport LazyLoadTransform from './LazyLoadTransform'\nimport Polyfill from './Polyfill'\nimport Throttle from './Throttle'\n\nconst EVENT_TYPES = ['scroll', 'resize', CollapseTable.SECTION_TOGGLED_EVENT_TYPE]\nconst THROTTLE_PERIOD_MILLISECONDS = 100\n\n/**\n * This class subscribes to key page events, applying lazy load transforms or inversions as\n * applicable. It has external dependencies on the section-toggled custom event and the following\n * standard browser events: resize, scroll.\n */\nexport default class {\n  /**\n   * @param {!Window} window\n   * @param {!number} loadDistanceMultiplier Images within this multiple of the screen height are\n   *                                         loaded in either direction.\n   */\n  constructor(window, loadDistanceMultiplier) {\n    this._window = window\n    this._loadDistanceMultiplier = loadDistanceMultiplier\n\n    this._placeholders = []\n    this._registered = false\n    this._throttledLoadPlaceholders = Throttle.wrap(window, THROTTLE_PERIOD_MILLISECONDS,\n      () => this._loadPlaceholders())\n  }\n\n  /**\n   * Convert images with placeholders. Calling this function may register this instance to listen to\n   * page events.\n   * @param {!Element} element\n   * @return {void}\n   */\n  convertImagesToPlaceholders(element) {\n    const images = LazyLoadTransform.queryLazyLoadableImages(element)\n    const placeholders = LazyLoadTransform.convertImagesToPlaceholders(this._window.document,\n      images)\n    this._placeholders = this._placeholders.concat(placeholders)\n    this._register()\n  }\n\n  /**\n   * Searches for existing placeholders in the DOM Document.\n   * This is an alternative to #convertImagesToPlaceholders if that was already done server-side.\n   * @param {!Element} element root element to start searching for placeholders\n   * @return {void}\n   */\n  collectExistingPlaceholders(element) {\n    const placeholders\n      = Polyfill.querySelectorAll(element, `.${LazyLoadTransform.PLACEHOLDER_CLASS}`)\n    this._placeholders = this._placeholders.concat(placeholders)\n    this._register()\n  }\n\n  /**\n   * Manually trigger a load images check. Calling this function may deregister this instance from\n   * listening to page events.\n   * @return {void}\n   */\n  loadPlaceholders() { this._throttledLoadPlaceholders() }\n\n  /**\n   * This method may be safely called even when already unregistered. This function clears the\n   * record of placeholders.\n   * @return {void}\n   */\n  deregister() {\n    if (!this._registered) { return }\n\n    EVENT_TYPES.forEach(eventType =>\n      this._window.removeEventListener(eventType, this._throttledLoadPlaceholders))\n    this._throttledLoadPlaceholders.reset()\n\n    this._placeholders = []\n    this._registered = false\n  }\n\n  /**\n   * This method may be safely called even when already registered.\n   * @return {void}\n   */\n  _register() {\n    if (this._registered || !this._placeholders.length) { return }\n    this._registered = true\n\n    EVENT_TYPES.forEach(eventType =>\n      this._window.addEventListener(eventType, this._throttledLoadPlaceholders))\n  }\n\n  /** @return {void} */\n  _loadPlaceholders() {\n    this._placeholders = this._placeholders.filter(placeholder => {\n      let pending = true\n      if (this._isPlaceholderEligibleToLoad(placeholder)) {\n        LazyLoadTransform.loadPlaceholder(this._window.document, placeholder)\n        pending = false\n      }\n      return pending\n    })\n\n    if (this._placeholders.length === 0) {\n      this.deregister()\n    }\n  }\n\n  /**\n   * @param {!HTMLSpanElement} placeholder\n   * @return {!boolean}\n   */\n  _isPlaceholderEligibleToLoad(placeholder) {\n    return ElementUtilities.isVisible(placeholder)\n      && this._isPlaceholderWithinLoadDistance(placeholder)\n  }\n\n  /**\n   * @param {!HTMLSpanElement} placeholder\n   * @return {!boolean}\n   */\n  _isPlaceholderWithinLoadDistance(placeholder) {\n    const bounds = placeholder.getBoundingClientRect()\n    const range = this._window.innerHeight * this._loadDistanceMultiplier\n    return !(bounds.top > range || bounds.bottom < -range)\n  }\n}","import Banana from 'banana-i18n'\nimport FooterContainer from '../../transform/FooterContainer'\nimport FooterLegal from '../../transform/FooterLegal'\nimport FooterMenu from '../../transform/FooterMenu'\nimport FooterReadMore from '../../transform/FooterReadMore'\n\nlet handlers\n\n/**\n * Sets up the interaction handlers for the footer.\n * @param {!{}} newHandlers an object with handlers for {\n *   titlesRetrieved, footerItemSelected, saveOtherPage, viewLicense, viewInBrowser\n * }\n * @return {void}\n */\nconst _connectHandlers = newHandlers => {\n  handlers = newHandlers\n}\n\n/**\n * Adds footer to the end of the document\n * @param {!Object.<any>} params parameters as follows\n *   {!string} title article title for related pages\n *   {!map} menu\n *       {!array<string>} items menu items to add\n *   {!map} readMore\n *       {!number} itemCount number of read more items to add\n *       {!string} baseURL base url for RESTBase to fetch read more\n *   {!map} l10n localized strings\n * @return {void}\n */\nconst add = params => {\n  const { title: articleTitle, menu: { items: menuItems, languageCount, editedDaysAgo },\n    readMore: { itemCount: readMoreItemCount, baseURL: readMoreBaseURL } } = params\n\n  // Add container\n  if (FooterContainer.isContainerAttached(document) === false) {\n    const pcs = document.getElementById('pcs')\n    pcs.appendChild(FooterContainer.containerFragment(document))\n  }\n\n  /**\n   * Callback for after i18n messages are loaded.\n   * @param {!Banana} banana\n   * @return {void}\n   */\n  const finish = banana => {\n    // Add menu\n    FooterMenu.setHeading(\n      banana.i18n('article-about-title'),\n      'pcs-footer-container-menu-heading',\n      document\n    )\n    menuItems.forEach(item => {\n      let title = ''\n      let subtitle = ''\n      switch (item) {\n      case FooterMenu.MenuItemType.languages:\n        title = languageCount && languageCount > 0 ? banana.i18n('page-read-in-other-languages', languageCount) : ''\n        break\n      case FooterMenu.MenuItemType.lastEdited:\n        title = banana.i18n('page-edit-history')\n        subtitle = editedDaysAgo !== undefined && editedDaysAgo >= 0 ? banana.i18n('page-last-edited', editedDaysAgo) : ''\n        break\n      case FooterMenu.MenuItemType.pageIssues:\n        title = banana.i18n('page-issues')\n        break\n      case FooterMenu.MenuItemType.disambiguation:\n        title = banana.i18n('page-similar-titles')\n        break\n      case FooterMenu.MenuItemType.coordinate:\n        title = banana.i18n('page-location')\n        break\n      case FooterMenu.MenuItemType.talkPage:\n        title = banana.i18n('page-talk-page')\n        break\n      default:\n      }\n\n      /**\n       * @param {!map} payload menu item payload\n       * @return {void}\n       */\n      const itemSelectionHandler = payload => {\n        if (handlers) {\n          handlers.footerItemSelected(item, payload)\n        }\n      }\n\n      FooterMenu.maybeAddItem(\n        title,\n        subtitle,\n        item,\n        'pcs-footer-container-menu-items',\n        itemSelectionHandler,\n        document\n      )\n    })\n\n    if (readMoreItemCount && readMoreItemCount > 0) {\n\n      /**\n       * @param {!list} titles article titles\n       * @return {void}\n       */\n      const titlesShownHandler = titles => {\n        if (handlers) {\n          handlers.titlesRetrieved(titles)\n        }\n      }\n\n      FooterReadMore.fetchAndAdd(\n        articleTitle,\n        banana.i18n('article-read-more-title'),\n        readMoreItemCount,\n        'pcs-footer-container-readmore',\n        'pcs-footer-container-readmore-pages',\n        readMoreBaseURL,\n        titlesShownHandler,\n        document\n      )\n    }\n\n    /**\n     * @return {void}\n     */\n    const licenseLinkClickHandler = () => {\n      if (handlers) {\n        handlers.viewLicense()\n      }\n    }\n\n    /**\n     * @return {void}\n     */\n    const viewInBrowserLinkClickHandler = () => {\n      if (handlers) {\n        handlers.viewInBrowser()\n      }\n    }\n\n    FooterLegal.add(\n      document,\n      banana.i18n('license-footer-text'),\n      banana.i18n('license-footer-name'),\n      'pcs-footer-container-legal',\n      licenseLinkClickHandler,\n      banana.i18n('view-in-browser-footer-link'),\n      viewInBrowserLinkClickHandler\n    )\n\n  }\n\n\n  const xhr = new XMLHttpRequest() // eslint-disable-line no-undef\n  const href = window.location.href || ''\n  const index = href.indexOf('/page/mobile-html/') // hax\n  const stringsBaseURL = index >= 0 ? href.slice(0, index) : ''\n  const stringsURL = `${stringsBaseURL}/data/i18n/pcs`\n  xhr.open('GET', stringsURL, true)\n  const failsafeBanana = {\n    i18n: message => message\n  }\n  xhr.onload = () => {\n    let banana\n    try {\n      const response = JSON.parse(xhr.responseText)\n      banana = new Banana(response.locale)\n      banana.load(response.messages)\n    } catch (e) {\n      banana = failsafeBanana\n    }\n    finish(banana)\n  }\n  xhr.onerror = () => {\n    finish(failsafeBanana)\n  }\n  xhr.send()\n}\n\nexport default {\n  MenuItemType: FooterMenu.MenuItemType,\n  add,\n  _connectHandlers // to be used internally only\n}","import CollapseTable from '../../transform/CollapseTable'\nimport EditTransform from '../../transform/EditTransform'\nimport Footer from './Footer'\nimport LazyLoadTransform from '../../transform/LazyLoadTransform'\nimport ReferenceCollection from '../../transform/ReferenceCollection'\nimport SectionUtilities from '../../transform/SectionUtilities'\n\n/**\n * Type of actions users can click which may need to be handled by the native side.\n * @type {!Object}\n */\nconst Actions = {\n  InitialSetup: 'setup',\n  FinalSetup: 'final_setup',\n  LinkClicked: 'link',\n  ImageClicked: 'image',\n  ReferenceClicked: 'reference',\n  BackLink: 'back_link',\n  EditSection: 'edit_section',\n  AddTitleDescription: 'add_title_description',\n  PronunciationClicked: 'pronunciation',\n  ScrollToAnchor: 'scroll_to_anchor',\n  /* Footer related actions: */\n  FooterItemSelected: 'footer_item',\n  SaveOtherPage: 'save_other_page',\n  ReadMoreTitlesRetrieved: 'read_more_titles_retrieved',\n  ViewLicense: 'view_license',\n  ViewInBrowser: 'view_in_browser',\n}\n\nlet interactionHandler\n\n/**\n * Model of an Interaction.\n */\nclass Interaction {\n  /**\n   * @param {!string} action the type of action\n   * @param {?Object.<any>} data details of the action\n   */\n  constructor(action, data) {\n    this.action = action\n    this.data = data\n  }\n}\n\n/**\n * Type of items users can click which we may need to handle.\n * @type {!Object}\n */\nconst ItemType = {\n  unknown: 0,\n  link: 1,\n  image: 2,\n  imagePlaceholder: 3,\n  reference: 4,\n  backLink: 5\n}\n\n/**\n * Model of clicked item.\n * Reminder: separate `target` and `href` properties\n * needed to handle non-anchor targets such as images.\n */\nclass ClickedItem {\n  /**\n   * @param {!EventTarget} target event target\n   * @param {!string} href\n   * @param {!string} pageLinkTitle last path component of the current document as read\n   * from dc:isVersionOf\n   */\n  constructor(target, href, pageLinkTitle) {\n    this.target = target\n    this.href = href\n    this.pageLinkTitle = pageLinkTitle\n  }\n\n  /**\n   * Determines type of item based on its properties.\n   * @return {!ItemType} Type of the item\n   */\n  type() {\n    if (ReferenceCollection.isCitation(this.href, this.pageLinkTitle)) {\n      return ItemType.reference\n    } if (ReferenceCollection.isBackLink(this.href, this.pageLinkTitle)) {\n      return ItemType.backLink\n    } else if (this.target.tagName === 'IMG'\n      && (this.target.classList.contains(LazyLoadTransform.CLASSES.IMAGE_LOADED_CLASS)\n          || this.target.classList.contains(LazyLoadTransform.CLASSES.IMAGE_LOADING_CLASS))\n      && (this.target.closest('figure') || this.target.closest('figure-inline'))\n    ) {\n      return ItemType.image\n    } else if (this.target.tagName === 'SPAN'\n      && this.target.classList.contains(LazyLoadTransform.CLASSES.PLACEHOLDER_CLASS)\n      && (this.target.closest('figure') || this.target.closest('figure-inline'))\n    ) {\n      return ItemType.imagePlaceholder\n    } else if (this.href) {\n      return ItemType.link\n    }\n    return ItemType.unknown\n  }\n}\n\n/**\n * Posts a message to native land using the interaction handler.\n * @param {Interaction} interaction the interaction data\n * @return {void}\n */\nconst postMessage = interaction => {\n  if (interactionHandler) {\n    interactionHandler(interaction)\n  }\n}\n\n/**\n * Posts message for a link click.\n * @param {!Element} target element\n * @param {!string} href url\n * @return {void}\n */\nconst postMessageForLink = (target, href) => {\n  if (href[0] === '#') {\n    CollapseTable.expandCollapsedTableIfItContainsElement(\n      document.getElementById(href.substring(1)))\n  }\n  postMessage(new Interaction(Actions.LinkClicked, {\n    href,\n    text: target.innerText,\n    title: target.title,\n    source: target.getAttribute('data-pcs-source')\n  }))\n}\n\n/**\n * Canonical file href\n * @param {!string} href url for the image\n * @return {!string} canonicalized file href\n */\nconst canonicalFileHref = href => href && href.replace(/^\\.\\/.+:/g, './File:')\n\n/**\n * Posts message for an image click.\n * @param {!Element} target an image element\n * @param {!string} href url for the image\n * @return {void}\n */\nconst postMessageForImage = (target, href) => {\n  const canonicalHref = canonicalFileHref(href)\n  postMessage(new Interaction(Actions.ImageClicked, {\n    href: canonicalHref,\n    src: target.getAttribute('src'),\n    'data-file-width': target.getAttribute('data-file-width'),\n    'data-file-height': target.getAttribute('data-file-height')\n  }))\n}\n\n/**\n * Posts a message for a lazy load image placeholder click.\n * @param {!Element} innerPlaceholderSpan\n * @param {!string} href url for the image\n * @return {void}\n */\nconst postMessageForImagePlaceholder = (innerPlaceholderSpan, href) => {\n  const outerSpan = innerPlaceholderSpan.parentElement\n  const canonicalHref = canonicalFileHref(href)\n  postMessage(new Interaction(Actions.ImageClicked, {\n    href: canonicalHref,\n    src: outerSpan.getAttribute('data-src'),\n    'data-file-width': outerSpan.getAttribute('data-data-file-width'),\n    'data-file-height': outerSpan.getAttribute('data-data-file-height')\n  }))\n}\n\n/**\n * Posts a message for a reference click.\n * @param {!Element} target an anchor element\n * @param {?string} href\n * @return {void}\n */\nconst postMessageForReferenceWithTarget = (target, href) => {\n  const nearbyReferences = ReferenceCollection.collectNearbyReferences(document, target)\n  nearbyReferences.href = href\n  postMessage(new Interaction(Actions.ReferenceClicked, nearbyReferences))\n}\n\n/**\n * Posts a message for a back link click.\n * @param {!Element} target an anchor element\n * @param {?string} href\n * @return {void}\n */\nconst postMessageForBackLinkWithTarget = (target, href) => {\n  const nearbyReferences = ReferenceCollection.collectReferencesForBackLink(document, target, href)\n  postMessage(new Interaction(Actions.BackLink, nearbyReferences))\n}\n\n/**\n * Post messages to native land for respective click types.\n * @param  {!ClickedItem} item the item which was clicked on\n * @return {boolean} `true` if a message was sent, otherwise `false`\n */\nconst postMessageForClickedItem = item => {\n  switch (item.type()) {\n  case ItemType.link:\n    postMessageForLink(item.target.closest('a'), item.href)\n    break\n  case ItemType.image:\n    postMessageForImage(item.target, item.href)\n    break\n  case ItemType.imagePlaceholder:\n    postMessageForImagePlaceholder(item.target, item.href)\n    break\n  case ItemType.reference:\n    postMessageForReferenceWithTarget(item.target, item.href)\n    break\n  case ItemType.backLink:\n    postMessageForBackLinkWithTarget(item.target, item.href)\n    break\n  default:\n    return false\n  }\n  return true\n}\n\n/**\n * Handler for the click event. Posts messages across the JS bridge to native land.\n * @param  {Event} event the event being handled\n * @return {void}\n */\nconst handleClickEvent = event => {\n  const target = event.target\n  if (!target) {\n    return\n  }\n  // Find anchor for non-anchor targets - like images.\n  const anchorForTarget = target.closest('A')\n  if (!anchorForTarget) {\n    return\n  }\n\n  // Handle edit links.\n  if (anchorForTarget.getAttribute('data-action') === 'edit_section') {\n    const sectionId = anchorForTarget.getAttribute('data-id') || undefined\n    const data = { sectionId }\n    if (sectionId && sectionId === 0) {\n      const descriptionElement = document.getElementById(EditTransform.IDS.TITLE_DESCRIPTION)\n      data.descriptionSource = descriptionElement && descriptionElement.getAttribute(EditTransform.DATA_ATTRIBUTE.DESCRIPTION_SOURCE) || undefined\n    }\n    postMessage(new Interaction(Actions.EditSection, data))\n    return\n  }\n\n  // Handle add title description link.\n  if (anchorForTarget.getAttribute('data-action') === 'add_title_description') {\n    postMessage(new Interaction(Actions.AddTitleDescription))\n    return\n  }\n\n  // Handle audio pronunciation button.\n  if (anchorForTarget.getAttribute('data-action') === 'title_pronunciation') {\n    const url = anchorForTarget.getAttribute(EditTransform.DATA_ATTRIBUTE.PRONUNCIATION_URL) || undefined\n    postMessage(new Interaction(Actions.PronunciationClicked, { url }))\n    return\n  }\n\n  const href = anchorForTarget.getAttribute('href')\n  if (!href) {\n    return\n  }\n  let pageTitle\n  const linkElement = document.head.querySelector('link[rel=\"dc:isVersionOf\"]')\n  if (linkElement) {\n    const linkHref = linkElement.href\n    if (linkHref) {\n      const components = linkHref.split('/')\n      pageTitle = components.pop()\n      if (pageTitle === '') {\n        pageTitle = components.pop\n      }\n    }\n  }\n  postMessageForClickedItem(new ClickedItem(target, href, pageTitle))\n}\n\n/**\n * @param {!string} itemType type of footer menu item\n * @param {!map} payload menu item payload\n * @return {void}\n */\nconst footerItemSelected = (itemType, payload) => {\n  postMessage(new Interaction(Actions.FooterItemSelected, { itemType, payload }))\n}\n\n/**\n * @param {!string} title page title\n * @return {void}\n */\nconst saveOtherPage = title => {\n  postMessage(new Interaction(Actions.SaveOtherPage, { title }))\n}\n\n/**\n * @param {!list<string>} titles list of 'Read more' page titles\n * @return {void}\n */\nconst titlesRetrieved = titles => {\n  postMessage(new Interaction(Actions.ReadMoreTitlesRetrieved, { titles }))\n}\n\n/**\n * @return {void}\n */\nconst viewLicense = () => {\n  postMessage(new Interaction(Actions.ViewLicense))\n}\n\n/**\n * @return {void}\n */\nconst viewInBrowser = () => {\n  postMessage(new Interaction(Actions.ViewInBrowser))\n}\n\n/**\n * @return {void}\n */\nconst initialSetupComplete = () => {\n  postMessage(new Interaction(Actions.InitialSetup))\n}\n\n/**\n * @return {void}\n */\nconst finalSetupComplete = () => {\n  postMessage(new Interaction(Actions.FinalSetup))\n}\n\n/**\n * @param {!string} anchor id for the element\n * @param {!string} rect client rect for the element\n * @return {void}\n */\nconst scrollToAnchor = (anchor, rect) => {\n  postMessage(new Interaction(Actions.ScrollToAnchor, { anchor, rect, href: `#${anchor}` }))\n}\n\n/**\n * Gets information about the current text selection\n * @param {?Window} optionalWindow\n * @return {!map} selection info\n */\nconst getSelectionInfo = optionalWindow => {\n  const selection = (optionalWindow || window).getSelection()\n  const text = selection.toString()\n  const anchorNode = selection.anchorNode\n  const section = SectionUtilities.getSectionIDOfElement(anchorNode)\n  const isTitleDescription = anchorNode &&\n      anchorNode.parentElement &&\n      anchorNode.parentElement.id === 'pcs-edit-section-title-description' ||\n      false\n  return { text, section, isTitleDescription }\n}\n\n/**\n * Sets the interaction handler function.\n * @param {!~Function} myHandlerFunction a platform specific bridge function.\n * On iOS consider using something like:\n *   (interaction) => { window.webkit.messageHandlers.interaction.postMessage(interaction) }\n * On Android consider using something like:\n *   (interaction) => { window.InteractionWebInterface.post(interaction) }\n * To test in a browser consider using something like:\n *   (interaction) => { console.log(JSON.stringify(interaction)) }\n * @return {void}\n */\nconst setInteractionHandler = myHandlerFunction => {\n  interactionHandler = myHandlerFunction\n\n  Footer._connectHandlers({\n    footerItemSelected,\n    saveOtherPage,\n    titlesRetrieved,\n    viewLicense,\n    viewInBrowser\n  })\n\n  // Associate our custom click handler logic with the document `click` event.\n  document.addEventListener('click', event => {\n    event.preventDefault()\n    handleClickEvent(event)\n  }, false)\n}\n\nexport default {\n  Actions,\n  getSelectionInfo,\n  setInteractionHandler,\n  initialSetupComplete,\n  finalSetupComplete,\n  scrollToAnchor\n}","import CollapseTable from '../../transform/CollapseTable'\nimport EditTransform from '../../transform/EditTransform'\nimport Polyfill from '../../transform/Polyfill'\n\nconst selectors = {\n  addTitleDescription: `#${EditTransform.IDS.ADD_TITLE_DESCRIPTION}`,\n  tableInfobox: `.${CollapseTable.CLASS.TABLE_INFOBOX}`,\n  tableOther: `.${CollapseTable.CLASS.TABLE_OTHER}`,\n  tableClose: `.${CollapseTable.CLASS.COLLAPSED_BOTTOM}`,\n}\n\n/**\n * Change user visible labels in the WebView.\n * @param {!{string}} localizedStrings a dictionary of localized strings {\n *   addTitleDescription, tableInfobox, tableOther, tableClose\n * }\n * @return {void}\n */\nconst localizeLabels = localizedStrings => {\n  for (const [key, selector] of Object.entries(selectors)) {\n    if (localizedStrings[key]) {\n      const elements = Polyfill.querySelectorAll(document, selector)\n      for (const element of elements) {\n        /* DOM sink status: risk? localizedStrings are client inputs,\n          which should be in full control by the apps */\n        element.innerHTML = localizedStrings[key]\n      }\n    }\n  }\n}\n\nexport default {\n  localizeLabels\n}","let scrollTop = 0\n\n/**\n * Sets the maximum top scroll position in pixel. Use this to adjust for any decor overlaying the\n * Viewport.\n * @param {!number} newValue pixel value\n * @return {void}\n */\nconst setScrollTop = newValue => {\n  scrollTop = newValue\n}\n\n/**\n * Gets maximum top scroll position in pixel.\n * @return {number}\n */\nconst getScrollTop = () => scrollTop\n\n/**\n * Scrolls the WebView to the top of the container parent node.\n * Can be used as FooterDivClickCallback\n * @param {!Element} container\n * @return {void}\n */\nconst scrollWithDecorOffset = container => {\n  window.scrollTo(0, container.parentNode.offsetTop - scrollTop)\n}\n\nexport default {\n  setScrollTop,\n  scrollWithDecorOffset,\n  testing: {\n    getScrollTop\n  }\n}","// Versioned abstraction layer. mobile-html clients are highly encouraged to go through this instead\n// of accessing the other JS functionality directly.\n// c1 stands for PCS client version 1.\n\nimport c1 from './c1'\n\nexport default {\n  c1\n}","import Footer from './Footer'\nimport InteractionHandling from './InteractionHandling'\nimport L10N from './L10N'\nimport Page from './Page'\nimport Platforms from './Platforms'\nimport Scroller from './Scroller'\nimport Sections from './Sections'\nimport Themes from './Themes'\n\nexport default {\n  Footer,\n  InteractionHandling,\n  L10N,\n  Platforms,\n  Page,\n  Scroller,\n  Sections,\n  Themes\n}","!function(u,e){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define([],e):\"object\"==typeof exports?exports.Banana=e():u.Banana=e()}(this,(function(){return function(u){var e={};function d(r){if(e[r])return e[r].exports;var t=e[r]={i:r,l:!1,exports:{}};return u[r].call(t.exports,t,t.exports,d),t.l=!0,t.exports}return d.m=u,d.c=e,d.d=function(u,e,r){d.o(u,e)||Object.defineProperty(u,e,{enumerable:!0,get:r})},d.r=function(u){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(u,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(u,\"__esModule\",{value:!0})},d.t=function(u,e){if(1&e&&(u=d(u)),8&e)return u;if(4&e&&\"object\"==typeof u&&u&&u.__esModule)return u;var r=Object.create(null);if(d.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:u}),2&e&&\"string\"!=typeof u)for(var t in u)d.d(r,t,function(e){return u[e]}.bind(null,t));return r},d.n=function(u){var e=u&&u.__esModule?function(){return u.default}:function(){return u};return d.d(e,\"a\",e),e},d.o=function(u,e){return Object.prototype.hasOwnProperty.call(u,e)},d.p=\"\",d(d.s=2)}([function(u){u.exports=JSON.parse('{\"ar\":\"\",\"fa\":\"\",\"ml\":\"\",\"kn\":\"\",\"lo\":\"\",\"or\":\"\",\"kh\":\"\",\"nqo\":\"\",\"pa\":\"\",\"gu\":\"\",\"hi\":\"\",\"my\":\"\",\"ta\":\"\",\"te\":\"\",\"th\":\"\",\"bo\":\"\"}')},function(u){u.exports=JSON.parse('{\"ab\":[\"ru\"],\"ace\":[\"id\"],\"aln\":[\"sq\"],\"als\":[\"gsw\",\"de\"],\"an\":[\"es\"],\"anp\":[\"hi\"],\"arn\":[\"es\"],\"arz\":[\"ar\"],\"av\":[\"ru\"],\"ay\":[\"es\"],\"ba\":[\"ru\"],\"bar\":[\"de\"],\"bat-smg\":[\"sgs\",\"lt\"],\"bcc\":[\"fa\"],\"be-x-old\":[\"be-tarask\"],\"bh\":[\"bho\"],\"bjn\":[\"id\"],\"bm\":[\"fr\"],\"bpy\":[\"bn\"],\"bqi\":[\"fa\"],\"bug\":[\"id\"],\"cbk-zam\":[\"es\"],\"ce\":[\"ru\"],\"crh\":[\"crh-latn\"],\"crh-cyrl\":[\"ru\"],\"csb\":[\"pl\"],\"cv\":[\"ru\"],\"de-at\":[\"de\"],\"de-ch\":[\"de\"],\"de-formal\":[\"de\"],\"dsb\":[\"de\"],\"dtp\":[\"ms\"],\"egl\":[\"it\"],\"eml\":[\"it\"],\"ff\":[\"fr\"],\"fit\":[\"fi\"],\"fiu-vro\":[\"vro\",\"et\"],\"frc\":[\"fr\"],\"frp\":[\"fr\"],\"frr\":[\"de\"],\"fur\":[\"it\"],\"gag\":[\"tr\"],\"gan\":[\"gan-hant\",\"zh-hant\",\"zh-hans\"],\"gan-hans\":[\"zh-hans\"],\"gan-hant\":[\"zh-hant\",\"zh-hans\"],\"gl\":[\"pt\"],\"glk\":[\"fa\"],\"gn\":[\"es\"],\"gsw\":[\"de\"],\"hif\":[\"hif-latn\"],\"hsb\":[\"de\"],\"ht\":[\"fr\"],\"ii\":[\"zh-cn\",\"zh-hans\"],\"inh\":[\"ru\"],\"iu\":[\"ike-cans\"],\"jut\":[\"da\"],\"jv\":[\"id\"],\"kaa\":[\"kk-latn\",\"kk-cyrl\"],\"kbd\":[\"kbd-cyrl\"],\"khw\":[\"ur\"],\"kiu\":[\"tr\"],\"kk\":[\"kk-cyrl\"],\"kk-arab\":[\"kk-cyrl\"],\"kk-latn\":[\"kk-cyrl\"],\"kk-cn\":[\"kk-arab\",\"kk-cyrl\"],\"kk-kz\":[\"kk-cyrl\"],\"kk-tr\":[\"kk-latn\",\"kk-cyrl\"],\"kl\":[\"da\"],\"ko-kp\":[\"ko\"],\"koi\":[\"ru\"],\"krc\":[\"ru\"],\"ks\":[\"ks-arab\"],\"ksh\":[\"de\"],\"ku\":[\"ku-latn\"],\"ku-arab\":[\"ckb\"],\"kv\":[\"ru\"],\"lad\":[\"es\"],\"lb\":[\"de\"],\"lbe\":[\"ru\"],\"lez\":[\"ru\"],\"li\":[\"nl\"],\"lij\":[\"it\"],\"liv\":[\"et\"],\"lmo\":[\"it\"],\"ln\":[\"fr\"],\"ltg\":[\"lv\"],\"lzz\":[\"tr\"],\"mai\":[\"hi\"],\"map-bms\":[\"jv\",\"id\"],\"mg\":[\"fr\"],\"mhr\":[\"ru\"],\"min\":[\"id\"],\"mo\":[\"ro\"],\"mrj\":[\"ru\"],\"mwl\":[\"pt\"],\"myv\":[\"ru\"],\"mzn\":[\"fa\"],\"nah\":[\"es\"],\"nap\":[\"it\"],\"nds\":[\"de\"],\"nds-nl\":[\"nl\"],\"nl-informal\":[\"nl\"],\"no\":[\"nb\"],\"os\":[\"ru\"],\"pcd\":[\"fr\"],\"pdc\":[\"de\"],\"pdt\":[\"de\"],\"pfl\":[\"de\"],\"pms\":[\"it\"],\"pt\":[\"pt-br\"],\"pt-br\":[\"pt\"],\"qu\":[\"es\"],\"qug\":[\"qu\",\"es\"],\"rgn\":[\"it\"],\"rmy\":[\"ro\"],\"roa-rup\":[\"rup\"],\"rue\":[\"uk\",\"ru\"],\"ruq\":[\"ruq-latn\",\"ro\"],\"ruq-cyrl\":[\"mk\"],\"ruq-latn\":[\"ro\"],\"sa\":[\"hi\"],\"sah\":[\"ru\"],\"scn\":[\"it\"],\"sg\":[\"fr\"],\"sgs\":[\"lt\"],\"sli\":[\"de\"],\"sr\":[\"sr-ec\"],\"srn\":[\"nl\"],\"stq\":[\"de\"],\"su\":[\"id\"],\"szl\":[\"pl\"],\"tcy\":[\"kn\"],\"tg\":[\"tg-cyrl\"],\"tt\":[\"tt-cyrl\",\"ru\"],\"tt-cyrl\":[\"ru\"],\"ty\":[\"fr\"],\"udm\":[\"ru\"],\"ug\":[\"ug-arab\"],\"uk\":[\"ru\"],\"vec\":[\"it\"],\"vep\":[\"et\"],\"vls\":[\"nl\"],\"vmf\":[\"de\"],\"vot\":[\"fi\"],\"vro\":[\"et\"],\"wa\":[\"fr\"],\"wo\":[\"fr\"],\"wuu\":[\"zh-hans\"],\"xal\":[\"ru\"],\"xmf\":[\"ka\"],\"yi\":[\"he\"],\"za\":[\"zh-hans\"],\"zea\":[\"nl\"],\"zh\":[\"zh-hans\"],\"zh-classical\":[\"lzh\"],\"zh-cn\":[\"zh-hans\"],\"zh-hant\":[\"zh-hans\"],\"zh-hk\":[\"zh-hant\",\"zh-hans\"],\"zh-min-nan\":[\"nan\"],\"zh-mo\":[\"zh-hk\",\"zh-hant\",\"zh-hans\"],\"zh-my\":[\"zh-sg\",\"zh-hans\"],\"zh-sg\":[\"zh-hans\"],\"zh-tw\":[\"zh-hant\",\"zh-hans\"],\"zh-yue\":[\"yue\"]}')},function(u,e,d){\"use strict\";d.r(e);var r=d(0);class t{constructor(u){this.locale=u}convertPlural(u,e){var d=new RegExp(\"\\\\d+=\",\"i\");if(!e||0===e.length)return\"\";for(let r=0;r<e.length;r++){let t=e[r];if(d.test(t)){if(parseInt(t.slice(0,t.indexOf(\"=\")),10)===u)return t.slice(t.indexOf(\"=\")+1);e[r]=void 0}}e=e.filter(u=>!!u);let r=this.getPluralForm(u,this.locale);return r=Math.min(r,e.length-1),e[r]}getPluralForm(u,e){const d=new Intl.PluralRules(e),r=d.resolvedOptions().pluralCategories,t=d.select(u);return[\"zero\",\"one\",\"two\",\"few\",\"many\",\"other\"].filter(u=>r.includes(u)).indexOf(t)}convertNumber(u,e){let d=this.digitTransformTable(this.locale),r=String(u),t=\"\";if(!d)return u;if(e){if(parseFloat(u,10)===u)return u;let e=[];for(let u in d)e[d[u]]=u;d=e}for(let u=0;u<r.length;u++)d[r[u]]?t+=d[r[u]]:t+=r[u];return e?parseFloat(t,10):t}convertGrammar(u,e){return u}gender(u,e){if(!e||0===e.length)return\"\";for(;e.length<2;)e.push(e[e.length-1]);return\"male\"===u?e[0]:\"female\"===u?e[1]:3===e.length?e[2]:e[0]}digitTransformTable(u){return!!r[u]&&r[u].split(\"\")}}var a={bs:class extends t{convertGrammar(u,e){switch(e){case\"instrumental\":u=\"s \"+u;break;case\"lokativ\":u=\"o \"+u}return u}},default:t,dsb:class extends t{convertGrammar(u,e){switch(e){case\"instrumental\":u=\"z \"+u;break;case\"lokatiw\":u=\"wo \"+u}return u}},fi:class extends t{convertGrammar(u,e){let d=u.match(/[aou][^y]*$/i),r=u;switch(u.match(/wiki$/i)&&(d=!1),u.match(/[bcdfghjklmnpqrstvwxz]$/i)&&(u+=\"i\"),e){case\"genitive\":u+=\"n\";break;case\"elative\":u+=d?\"sta\":\"st\";break;case\"partitive\":u+=d?\"a\":\"\";break;case\"illative\":u+=u.slice(-1)+\"n\";break;case\"inessive\":u+=d?\"ssa\":\"ss\";break;default:u=r}return u}},ga:class extends t{convertGrammar(u,e){if(\"ainmlae\"===e)switch(u){case\"an Domhnach\":u=\"D Domhnaigh\";break;case\"an Luan\":u=\"D Luain\";break;case\"an Mhirt\":u=\"D Mhirt\";break;case\"an Chadaoin\":u=\"D Chadaoin\";break;case\"an Dardaoin\":u=\"Dardaoin\";break;case\"an Aoine\":u=\"D hAoine\";break;case\"an Satharn\":u=\"D Sathairn\"}return u}},he:class extends t{convertGrammar(u,e){switch(e){case\"prefixed\":case\"\":\"\"===u.slice(0,1)&&\"\"!==u.slice(0,2)&&(u=\"\"+u),\"\"===u.slice(0,1)&&(u=u.slice(1)),(u.slice(0,1)<\"\"||u.slice(0,1)>\"\")&&(u=\"\"+u)}return u}},hsb:class extends t{convertGrammar(u,e){switch(e){case\"instrumental\":u=\"z \"+u;break;case\"lokatiw\":u=\"wo \"+u}return u}},hu:class extends t{convertGrammar(u,e){switch(e){case\"rol\":u+=\"rl\";break;case\"ba\":u+=\"ba\";break;case\"k\":u+=\"k\"}return u}},hy:class extends t{convertGrammar(u,e){return\"genitive\"===e&&(\"\"===u.slice(-1)?u=u.slice(0,-1)+\"\":\"\"===u.slice(-1)?u=u.slice(0,-1)+\"\":\"\"===u.slice(-4)?u=u.slice(0,-4)+\"\":u+=\"\"),u}},la:class extends t{convertGrammar(u,e){switch(e){case\"genitive\":u=(u=(u=(u=(u=(u=(u=(u=(u=u.replace(/u[ms]$/i,\"i\")).replace(/ommunia$/i,\"ommunium\")).replace(/a$/i,\"ae\")).replace(/libri$/i,\"librorum\")).replace(/nuntii$/i,\"nuntiorum\")).replace(/tio$/i,\"tionis\")).replace(/ns$/i,\"ntis\")).replace(/as$/i,\"atis\")).replace(/es$/i,\"ei\");break;case\"accusative\":u=(u=(u=(u=(u=(u=(u=(u=(u=u.replace(/u[ms]$/i,\"um\")).replace(/ommunia$/i,\"am\")).replace(/a$/i,\"ommunia\")).replace(/libri$/i,\"libros\")).replace(/nuntii$/i,\"nuntios\")).replace(/tio$/i,\"tionem\")).replace(/ns$/i,\"ntem\")).replace(/as$/i,\"atem\")).replace(/es$/i,\"em\");break;case\"ablative\":u=(u=(u=(u=(u=(u=(u=(u=(u=u.replace(/u[ms]$/i,\"o\")).replace(/ommunia$/i,\"ommunibus\")).replace(/a$/i,\"a\")).replace(/libri$/i,\"libris\")).replace(/nuntii$/i,\"nuntiis\")).replace(/tio$/i,\"tione\")).replace(/ns$/i,\"nte\")).replace(/as$/i,\"ate\")).replace(/es$/i,\"e\")}return u}},os:class extends t{convertGrammar(u,e){var d,r,t,a;switch(d=\"\",r=\"\",t=\"\",a=\"\",u.match(/$/i)?(u=u.slice(0,-1),d=\"\"):u.match(/[]$/i)?r=\"\":u.match(/$/i)?u.slice(-2,-1).match(/[]$/i)||(r=\"\"):u.match(/[]$/i)||(t=\"-\"),e){case\"genitive\":a=t+r+\"\";break;case\"dative\":a=t+r+\"\";break;case\"allative\":a=t+d;break;case\"ablative\":a=\"\"===r?t+r+\"\":t+r+\"\";break;case\"superessive\":a=t+r+\"\";break;case\"equative\":a=t+r+\"\";break;case\"comitative\":a=t+\"\"}return u+a}},ru:class extends t{convertGrammar(u,e){return\"genitive\"===e&&(\"\"===u.slice(-1)?u=u.slice(0,-1)+\"\":\"\"===u.slice(-2)?u=u.slice(0,-2)+\"\":\"\"===u.slice(-2)?u=u.slice(0,-2)+\"\":\"\"===u.slice(-2)?u=u.slice(0,-2)+\"\":\"\"===u.slice(-2)?u=u.slice(0,-2)+\"\":\"\"===u.slice(-3)&&(u=u.slice(0,-3)+\"\")),u}},sl:class extends t{convertGrammar(u,e){switch(e){case\"mestnik\":u=\"o \"+u;break;case\"orodnik\":u=\"z \"+u}return u}},uk:class extends t{convertGrammar(u,e){switch(e){case\"genitive\":\"\"===u.slice(-1)?u=u.slice(0,-1)+\"\":\"\"===u.slice(-2)?u=u.slice(0,-2)+\"\":\"\"===u.slice(-2)?u=u.slice(0,-2)+\"\":\"\"===u.slice(-2)?u=u.slice(0,-2)+\"\":\"\"===u.slice(-2)?u=u.slice(0,-2)+\"\":\"\"===u.slice(-3)&&(u=u.slice(0,-3)+\"\");break;case\"accusative\":\"\"===u.slice(-2)&&(u=u.slice(0,-2)+\"\")}return u}}};const n=new RegExp(\"(?:([A-Za-z---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]|\\ud800[\\udc00-\\udc0b]|\\ud800[\\udc0d-\\udc26]|\\ud800[\\udc28-\\udc3a]|||\\ud800[\\udc3f-\\udc4d]|\\ud800[\\udc50-\\udc5d]|\\ud800[\\udc80-\\udcfa]|||\\ud800[\\udd07-\\udd33]|\\ud800[\\udd37-\\udd3f]|\\ud800[\\uddd0-\\uddfc]|\\ud800[\\ude80-\\ude9c]|\\ud800[\\udea0-\\uded0]|\\ud800[\\udf00-\\udf23]|\\ud800[\\udf30-\\udf4a]|\\ud800[\\udf50-\\udf75]|\\ud800[\\udf80-\\udf9d]|\\ud800[\\udf9f-\\udfc3]|\\ud800[\\udfc8-\\udfd5]|\\ud801[\\udc00-\\udc9d]|\\ud801[\\udca0-\\udca9]|\\ud801[\\udd00-\\udd27]|\\ud801[\\udd30-\\udd63]||\\ud801[\\ude00-\\udf36]|\\ud801[\\udf40-\\udf55]|\\ud801[\\udf60-\\udf67]||\\ud804[\\udc02-\\udc37]|\\ud804[\\udc47-\\udc4d]|\\ud804[\\udc66-\\udc6f]|\\ud804[\\udc82-\\udcb2]|||\\ud804[\\udcbb-\\udcc1]|\\ud804[\\udcd0-\\udce8]|\\ud804[\\udcf0-\\udcf9]|\\ud804[\\udd03-\\udd26]||\\ud804[\\udd36-\\udd43]|\\ud804[\\udd50-\\udd72]|\\ud804[\\udd74-\\udd76]|\\ud804[\\udd82-\\uddb5]|\\ud804[\\uddbf-\\uddc9]||\\ud804[\\uddd0-\\udddf]|\\ud804[\\udde1-\\uddf4]|\\ud804[\\ude00-\\ude11]|\\ud804[\\ude13-\\ude2e]||||\\ud804[\\ude38-\\ude3d]|\\ud804[\\ude80-\\ude86]||\\ud804[\\ude8a-\\ude8d]|\\ud804[\\ude8f-\\ude9d]|\\ud804[\\ude9f-\\udea9]|\\ud804[\\udeb0-\\udede]|\\ud804[\\udee0-\\udee2]|\\ud804[\\udef0-\\udef9]|||\\ud804[\\udf05-\\udf0c]|||\\ud804[\\udf13-\\udf28]|\\ud804[\\udf2a-\\udf30]|||\\ud804[\\udf35-\\udf39]|\\ud804[\\udf3d-\\udf3f]|\\ud804[\\udf41-\\udf44]|||\\ud804[\\udf4b-\\udf4d]|||\\ud804[\\udf5d-\\udf63]|\\ud805[\\udc80-\\udcb2]||\\ud805[\\udcbb-\\udcbe]||\\ud805[\\udcc4-\\udcc7]|\\ud805[\\udcd0-\\udcd9]|\\ud805[\\udd80-\\uddb1]|\\ud805[\\uddb8-\\uddbb]||\\ud805[\\uddc1-\\udddb]|\\ud805[\\ude00-\\ude32]||||\\ud805[\\ude41-\\ude44]|\\ud805[\\ude50-\\ude59]|\\ud805[\\ude80-\\udeaa]|||||\\ud805[\\udec0-\\udec9]|\\ud805[\\udf00-\\udf19]||||\\ud805[\\udf30-\\udf3f]|\\ud806[\\udca0-\\udcf2]||\\ud806[\\udec0-\\udef8]|\\ud808[\\udc00-\\udf99]|\\ud809[\\udc00-\\udc6e]|\\ud809[\\udc70-\\udc74]|\\ud809[\\udc80-\\udd43]|\\ud80c[\\udc00-\\udfff]|\\ud80d[\\udc00-\\udc2e]|\\ud811[\\udc00-\\ude46]|\\ud81a[\\udc00-\\ude38]|\\ud81a[\\ude40-\\ude5e]|\\ud81a[\\ude60-\\ude69]|||\\ud81a[\\uded0-\\udeed]||\\ud81a[\\udf00-\\udf2f]|\\ud81a[\\udf37-\\udf45]|\\ud81a[\\udf50-\\udf59]|\\ud81a[\\udf5b-\\udf61]|\\ud81a[\\udf63-\\udf77]|\\ud81a[\\udf7d-\\udf8f]|\\ud81b[\\udf00-\\udf44]|\\ud81b[\\udf50-\\udf7e]|\\ud81b[\\udf93-\\udf9f]|||\\ud82f[\\udc00-\\udc6a]|\\ud82f[\\udc70-\\udc7c]|\\ud82f[\\udc80-\\udc88]|\\ud82f[\\udc90-\\udc99]|||\\ud834[\\udc00-\\udcf5]|\\ud834[\\udd00-\\udd26]|\\ud834[\\udd29-\\udd66]|\\ud834[\\udd6a-\\udd72]|||\\ud834[\\udd8c-\\udda9]|\\ud834[\\uddae-\\udde8]|\\ud834[\\udf60-\\udf71]|\\ud835[\\udc00-\\udc54]|\\ud835[\\udc56-\\udc9c]||||||\\ud835[\\udca9-\\udcac]|\\ud835[\\udcae-\\udcb9]||\\ud835[\\udcbd-\\udcc3]|\\ud835[\\udcc5-\\udd05]|\\ud835[\\udd07-\\udd0a]|\\ud835[\\udd0d-\\udd14]|\\ud835[\\udd16-\\udd1c]|\\ud835[\\udd1e-\\udd39]|\\ud835[\\udd3b-\\udd3e]|\\ud835[\\udd40-\\udd44]||\\ud835[\\udd4a-\\udd50]|\\ud835[\\udd52-\\udea5]|\\ud835[\\udea8-\\udeda]|\\ud835[\\udedc-\\udf14]|\\ud835[\\udf16-\\udf4e]|\\ud835[\\udf50-\\udf88]|\\ud835[\\udf8a-\\udfc2]|\\ud835[\\udfc4-\\udfcb]|\\ud836[\\udc00-\\uddff]|\\ud836[\\ude37-\\ude3a]|\\ud836[\\ude6d-\\ude74]|\\ud836[\\ude76-\\ude83]|\\ud836[\\ude85-\\ude8b]|\\ud83c[\\udd10-\\udd2e]|\\ud83c[\\udd30-\\udd69]|\\ud83c[\\udd70-\\udd9a]|\\ud83c[\\udde6-\\ude02]|\\ud83c[\\ude10-\\ude3a]|\\ud83c[\\ude40-\\ude48]|||[\\ud840-\\ud868][\\udc00-\\udfff]|\\ud869[\\udc00-\\uded6]|\\ud869[\\udf00-\\udfff]|[\\ud86a-\\ud86c][\\udc00-\\udfff]|\\ud86d[\\udc00-\\udf34]|\\ud86d[\\udf40-\\udfff]|\\ud86e[\\udc00-\\udc1d]|\\ud86e[\\udc20-\\udfff]|[\\ud86f-\\ud872][\\udc00-\\udfff]|\\ud873[\\udc00-\\udea1]|\\ud87e[\\udc00-\\ude1d]|[\\udb80-\\udbbe][\\udc00-\\udfff]|\\udbbf[\\udc00-\\udffd]|[\\udbc0-\\udbfe][\\udc00-\\udfff]|\\udbff[\\udc00-\\udffd])|([-------------------]|\\ud802[\\udc00-\\udd1e]|\\ud802[\\udd20-\\ude00]||\\ud802[\\ude07-\\ude0b]|\\ud802[\\ude10-\\ude37]|\\ud802[\\ude3b-\\ude3e]|\\ud802[\\ude40-\\udee4]|\\ud802[\\udee7-\\udf38]|\\ud802[\\udf40-\\udfff]|\\ud803[\\udc00-\\ude5f]|\\ud803[\\ude7f-\\udfff]|\\ud83a[\\udc00-\\udccf]|\\ud83a[\\udcd7-\\udfff]|\\ud83b[\\udc00-\\uddff]|\\ud83b[\\udf00-\\udfff]|\\ud83b[\\udf00-\\udfff]|\\ud83b[\\udf00-\\udfff]|\\ud83b[\\udf00-\\udfff]|\\ud83b[\\udf00-\\udfff]|\\ud83b[\\udf00-\\udfff]|\\ud83b[\\udf00-\\udfff]|\\ud83b[\\udf00-\\udfff]|\\ud83b[\\udf00-\\udfff]|\\ud83b[\\udf00-\\udfff]|\\ud83b[\\udf00-\\udfff]|\\ud83b[\\udf00-\\udfff]|\\ud83b[\\udf00-\\udfff]|\\ud83b[\\ude00-\\udeef]|\\ud83b[\\udef2-\\udeff]))\");var c=class{constructor(u){this.locale=u,this.language=new(a[u]||a.default)(u)}emit(u,e){let d,r,t;switch(typeof u){case\"string\":case\"number\":d=u;break;case\"object\":if(r=u.slice(1).map(u=>this.emit(u,e)),t=u[0].toLowerCase(),\"function\"!=typeof this[t])throw new Error('unknown operation \"'+t+'\"');d=this[t](r,e);break;case\"undefined\":d=\"\";break;default:throw new Error(\"unexpected type in AST: \"+typeof u)}return d}concat(u){let e=\"\";return u.forEach(u=>{e+=u}),e}replace(u,e){let d=parseInt(u[0],10);return d<e.length?e[d]:\"$\"+(d+1)}plural(u){let e=parseFloat(this.language.convertNumber(u[0],10)),d=u.slice(1);return d.length?this.language.convertPlural(e,d):\"\"}gender(u){let e=u[0],d=u.slice(1);return this.language.gender(e,d)}grammar(u){let e=u[0],d=u[1];return d&&e&&this.language.convertGrammar(d,e)}bidi(u){var e=function(u){var e=u.match(n);if(!e)return null;if(void 0===e[2])return\"ltr\";return\"rtl\"}(u[0]);return\"ltr\"===e?\"\"+u[0]+\"\":\"rtl\"===e?\"\"+u[0]+\"\":u[0]}};function l(u){let e,d,r,t,a,n,c,l,s,i,f,o,h,b,m,p,k,g,v=0;function z(u){return()=>{for(let e=0;e<u.length;e++){let d=u[e]();if(null!==d)return d}return null}}function w(u){let e=v,d=[];for(let r=0;r<u.length;r++){let t=u[r]();if(null===t)return v=e,null;d.push(t)}return d}function y(u,e){return()=>{let d=v,r=[],t=e();for(;null!==t;)r.push(t),t=e();return r.length<u?(v=d,null):r}}function $(e){let d=e.length;return()=>{let r=null;return u.slice(v,v+d)===e&&(r=e,v+=d),r}}function x(e){return()=>{let d=u.slice(v).match(e);return null===d?null:(v+=d[0].length,d[0])}}function j(){let u=w([r,t]);return null===u?null:u[1]}function M(){let u=w([a,n]);return null===u?null:[\"REPLACE\",parseInt(u[1],10)-1]}var O,S;function G(){let u=w([e,y(0,k)]);if(null===u)return null;let d=u[1];return d.length>1?[\"CONCAT\"].concat(d):d[0]}function P(){let u=w([h,d,M]);return null===u?null:[u[0],u[2]]}function q(){let u=w([h,d,k]);return null===u?null:[u[0],u[2]]}function F(){let u=w([b,o,m]);return null===u?null:u[1]}if(e=$(\"|\"),d=$(\":\"),r=$(\"\\\\\"),t=x(/^./),a=$(\"$\"),n=x(/^\\d+/),c=x(/^[^{}[\\]$\\\\]/),l=x(/^[^{}[\\]$\\\\|]/),s=x(/^[^{}[\\]$\\s]/),z([j,s]),i=z([j,l]),f=z([j,c]),O=x(/^[ !\"$&'()*,./0-9;=?@A-Z^_`a-z~\\x80-\\xFF+-]+/),S=function(u){return u.toString()},h=()=>{let u=O();return null===u?null:S(u)},o=z([function(){let u=w([z([P,q]),y(0,G)]);return null===u?null:u[0].concat(u[1])},function(){let u=w([h,y(0,G)]);return null===u?null:[u[0]].concat(u[1])}]),b=$(\"{{\"),m=$(\"}}\"),p=z([F,M,function(){let u=y(1,f)();return null===u?null:u.join(\"\")}]),k=z([F,M,function(){let u=y(1,i)();return null===u?null:u.join(\"\")}]),g=function(){let u=y(0,p)();return null===u?null:[\"CONCAT\"].concat(u)}(),null===g||v!==u.length)throw new Error(\"Parse error at position \"+v.toString()+\" in input: \"+u);return g}class s{constructor(u){this.locale=u,this.emitter=new c(this.locale)}parse(u,e){if(u.includes(\"{{\")){let d=new l(u);return this.emitter.emit(d,e)}return this.simpleParse(u,e)}simpleParse(u,e){return u.replace(/\\$(\\d+)/g,(u,d)=>{let r=parseInt(d,10)-1;return void 0!==e[r]?e[r]:\"$\"+d})}}class i{constructor(u){this.sourceMap=new Map}load(u,e){if(\"object\"!=typeof u)throw Error(\"Invalid message source. Must be an object\");if(e){if(!/^[a-zA-Z0-9-]+$/.test(e))throw Error(`Invalid locale ${e}`);for(let d in u)if(0!==d.indexOf(\"@\")){if(\"object\"==typeof u[d])return this.load(u);if(\"string\"!=typeof u[d])throw Error(`Invalid message for message ${d} in ${e} locale.`);break}this.sourceMap.has(e)?this.sourceMap.set(e,Object.assign(this.sourceMap.get(e),u)):this.sourceMap.set(e,u)}else for(e in u)this.load(u[e],e)}getMessage(u,e){let d=this.sourceMap.get(e);return d?d[u]:null}hasLocale(u){return this.sourceMap.has(u)}}var f=d(1);d.d(e,\"default\",(function(){return o}));class o{constructor(u,e){e=e||{},this.locale=u,this.parser=new s(this.locale),this.messageStore=new i,e.messages&&this.load(e.messages,this.locale),this.finalFallback=e.finalFallback||\"en\"}load(u,e){return this.messageStore.load(u,e||this.locale)}i18n(u,...e){return this.parser.parse(this.getMessage(u),e)}setLocale(u){this.locale=u,this.parser=new s(this.locale)}getFallbackLocales(){return[...f[this.locale]||[],this.finalFallback]}getMessage(u){let e=this.locale,d=0;const r=this.getFallbackLocales(this.locale);for(;e;){let t=e.split(\"-\"),a=t.length;do{let e=t.slice(0,a).join(\"-\"),d=this.messageStore.getMessage(u,e);if(d)return d;a--}while(a);e=r[d],d++}return u}}}]).default}));\n//# sourceMappingURL=banana-i18n.js.map","import AdjustTextSize from '../../transform/AdjustTextSize'\nimport BodySpacingTransform from '../../transform/BodySpacingTransform'\nimport CollapseTable from '../../transform/CollapseTable'\nimport DimImagesTransform from '../../transform/DimImagesTransform'\nimport EditTransform from '../../transform/EditTransform'\nimport InteractionHandling from './InteractionHandling'\nimport L10N from './L10N'\nimport LazyLoadTransformer from '../../transform/LazyLoadTransformer'\nimport NodeUtilities from '../../transform/NodeUtilities'\nimport PlatformTransform from '../../transform/PlatformTransform'\nimport Scroller from './Scroller'\nimport SectionUtilities from '../../transform/SectionUtilities'\nimport ThemeTransform from '../../transform/ThemeTransform'\n\nconst unitsRegex = /[^0-9]+$/\n\nconst PCS_CSS_CLASS_ELEMENT_HIGHLIGHT = 'pcs-element-highlight'\n\n\n/**\n * @typedef {function} OnSuccess\n * @return {void}\n */\n\n/**\n * Waits for the next paint, then calls the callback\n * @param {?OnSuccess} onSuccess callback\n * @return {void}\n */\nconst waitForNextPaint = onSuccess => {\n  if (window && window.requestAnimationFrame) {\n    // request animation frame and set timeout before callback to ensure paint occurs\n    window.requestAnimationFrame(() => {\n      setTimeout(() => {\n        onSuccess()\n      }, 1)\n    })\n  } else {\n    onSuccess()\n  }\n}\n\n\n/**\n * Makes multiple page modifications based on client specific settings, which should be called\n * during initial page load.\n * @param {?{}} optionalSettings client settings\n *   { platform, clientVersion, l10n, theme, dimImages, margins, areTablesInitiallyExpanded,\n *   scrollTop, textSizeAdjustmentPercentage }\n * @param {?OnSuccess} onSuccess callback\n * @return {void}\n */\nconst setup = (optionalSettings, onSuccess) => {\n  const settings = optionalSettings || {}\n  if (settings.platform !== undefined) {\n    PlatformTransform.setPlatform(document, PlatformTransform.CLASS_PREFIX + settings.platform)\n  }\n  if (settings.l10n !== undefined) {\n    L10N.localizeLabels(settings.l10n)\n  }\n  if (settings.theme !== undefined) {\n    ThemeTransform.setTheme(document, ThemeTransform.CLASS_PREFIX + settings.theme)\n  }\n  if (settings.dimImages !== undefined) {\n    DimImagesTransform.dimImages(document, settings.dimImages)\n  }\n  let metaTags // lazy load these to avoid a double query selector\n  if (settings.margins !== undefined || settings.leadImageHeight !== undefined) {\n    const margins = settings.margins || {}\n    if (settings.leadImageHeight !== undefined) {\n      if (!metaTags) {\n        metaTags = getMetaTags()\n      }\n      const leadImage = getLeadImageFromMetaTags(metaTags)\n      if (leadImage.source) {\n        if (margins.top) {\n          const top = parseFloat(margins.top, 10)\n          const height = parseFloat(settings.leadImageHeight, 10)\n          const units = margins.top.match(unitsRegex) || ''\n          margins.top =  top + height + units\n        } else {\n          margins.top = settings.leadImageHeight\n        }\n      }\n    }\n    BodySpacingTransform.setMargins(document.body, margins)\n  }\n  if (settings.userGroups !== undefined) {\n    if (!metaTags) {\n      metaTags = getMetaTags()\n    }\n    const protection = getProtectionFromMetaTags(metaTags)\n    const isEditable = true\n    let isProtected = false\n    if (protection.edit) {\n      isProtected = true\n      for (let i = 0; i < settings.userGroups.length; i++) {\n        const userGroup = settings.userGroups[i]\n        if (userGroup === protection.edit) {\n          isProtected = false\n          break\n        }\n      }\n    }\n    setEditButtons(isEditable, isProtected)\n  }\n  if (settings.setupTableEventHandling === undefined || settings.setupTableEventHandling) {\n    const isInitiallyCollapsed = settings.areTablesInitiallyExpanded !== true\n    CollapseTable.setupEventHandling(window,\n      document,\n      isInitiallyCollapsed,\n      Scroller.scrollWithDecorOffset)\n  }\n  if (settings.scrollTop !== undefined) {\n    Scroller.setScrollTop(settings.scrollTop)\n  }\n  if (settings.textSizeAdjustmentPercentage !== undefined) {\n    AdjustTextSize.setPercentage(\n      document.body,\n      settings.textSizeAdjustmentPercentage\n    )\n  }\n  if (settings.loadImages === undefined || settings.loadImages === true) {\n    const lazyLoader = new LazyLoadTransformer(window, 2)\n    lazyLoader.collectExistingPlaceholders(document.body)\n    lazyLoader.loadPlaceholders()\n  }\n  waitForNextPaint(onSuccess)\n}\n\n/**\n * Sets the theme.\n * @param {!string} theme one of the values in Themes\n * @param {?OnSuccess} onSuccess callback\n * @return {void}\n */\nconst setTheme = (theme, onSuccess) => {\n  ThemeTransform.setTheme(document, theme)\n\n  if (onSuccess instanceof Function) {\n    onSuccess()\n  }\n}\n\n/**\n * Toggles dimming of images.\n * @param {!boolean} dimImages true if images should be dimmed, false otherwise\n * @param {?OnSuccess} onSuccess callback\n * @return {void}\n */\nconst setDimImages = (dimImages, onSuccess) => {\n  DimImagesTransform.dimImages(document, dimImages)\n\n  if (onSuccess instanceof Function) {\n    onSuccess()\n  }\n}\n\n/**\n * Sets the margins.\n * @param {!{BodySpacingTransform.Spacing}} margins\n * @param {?OnSuccess} onSuccess callback\n * @return {void}\n */\nconst setMargins = (margins, onSuccess) => {\n  BodySpacingTransform.setMargins(document.body, margins)\n\n  if (onSuccess instanceof Function) {\n    onSuccess()\n  }\n}\n\n/**\n * Sets the top scroll position for collapsing of tables (when bottom close button is tapped).\n * @param {!number} scrollTop height of decor covering the top portion of the Viewport in pixel\n * @param {?OnSuccess} onSuccess callback\n * @return {void}\n */\nconst setScrollTop = (scrollTop, onSuccess) => {\n  Scroller.setScrollTop(scrollTop)\n\n  if (onSuccess instanceof Function) {\n    onSuccess()\n  }\n}\n\n/**\n * Sets text size adjustment percentage of the body element\n * @param  {!string} textSize percentage for text-size-adjust in format of string, like '100%'\n * @param  {?OnSuccess} onSuccess onSuccess callback\n * @return {void}\n */\nconst setTextSizeAdjustmentPercentage = (textSize, onSuccess) => {\n  AdjustTextSize.setPercentage(document.body, textSize)\n\n  if (onSuccess instanceof Function) {\n    onSuccess()\n  }\n}\n\n/**\n * Enables edit buttons to be shown (and which ones).\n * @param {?boolean} isEditable true if edit buttons should be shown\n * @param {?boolean} isProtected true if the protected edit buttons should be shown\n * @param {?OnSuccess} onSuccess onSuccess callback\n * @return {void}\n */\nconst setEditButtons = (isEditable, isProtected, onSuccess) => {\n  EditTransform.setEditButtons(document, isEditable, isProtected)\n\n  if (onSuccess instanceof Function) {\n    onSuccess()\n  }\n}\n\n/**\n * Gets the revision of the current mobile-html page.\n * @return {?string}\n */\nconst getRevision = () => {\n  const about = document.documentElement.getAttribute('about')\n  if (!about) {\n    return undefined\n  }\n  return about.substring(about.lastIndexOf('/') + 1)\n}\n\n/**\n * Get structured table of contents data\n * @return {!Array}\n */\nconst getTableOfContents = () => {\n  const sections = document.querySelectorAll('section')\n  const result = []\n  const levelCounts = new Array(10).fill(0)\n  let lastLevel = 0;\n\n  [].forEach.call(sections, section => {\n    const id = parseInt(section.getAttribute('data-mw-section-id'), 10)\n    if (!id || isNaN(id) || id < 1) {\n      return\n    }\n    const headerEl = section.querySelector('h1,h2,h3,h4,h5,h6')\n    if (!headerEl) {\n      return\n    }\n    const level = parseInt(headerEl.tagName.charAt(1), 10) - 1\n    if (level < lastLevel) {\n      levelCounts.fill(0, level)\n    }\n    lastLevel = level\n    levelCounts[level - 1]++\n    result.push({\n      level,\n      id,\n      number: levelCounts.slice(0, level).map(n => n.toString()).join('.'),\n      anchor: headerEl.getAttribute('id'),\n      /* DOM sink status: safe - content transform with no user interference */\n      title: headerEl.innerHTML.trim()\n    })\n  })\n  return result\n}\n\n/**\n * Get protection information for the page from given meta tags\n * @private\n * @param {!Array} metaTags\n * @return {!map}\n */\nconst getProtectionFromMetaTags = metaTags => {\n  const protection = {}\n  const protectionPrefix = 'mw:pageProtection:'\n  const protectionPrefixLength = protectionPrefix.length\n  metaTags.forEach(metaTag => {\n    const property = metaTag.getAttribute('property')\n    if (property && property.startsWith(protectionPrefix)) {\n      protection[property.substring(protectionPrefixLength)] = metaTag.getAttribute('content')\n    }\n  })\n  return protection\n}\n\n/**\n * Return meta tags for the page\n * @private\n * @return {!Array}\n */\nconst getMetaTags = () => document.head.querySelectorAll('meta')\n\n/**\n * Get protection information for the page\n * @return {!map}\n */\nconst getProtection = () => getProtectionFromMetaTags(getMetaTags())\n\n/**\n * Ensures the element with the given anchor is visible before scrolling and returns the\n * boundingClientRect of that element\n * @param {!string} anchor of the element that will be scrolled to\n * @param {!{}} options object with options. currently only supports\n * highlight = true to highlight the element\n * @return {void}\n */\nconst prepareForScrollToAnchor = (anchor, options) => {\n  if (!document) {\n    return undefined\n  }\n  const element = document.getElementById(anchor)\n  if (!element) {\n    return undefined\n  }\n\n  SectionUtilities.expandCollapsedSectionIfItContainsElement(document, element)\n  CollapseTable.expandCollapsedTableIfItContainsElement(element)\n\n  if (options && options.highlight) {\n    removeHighlightsFromHighlightedElements()\n    element.classList.add(PCS_CSS_CLASS_ELEMENT_HIGHLIGHT)\n  }\n\n  waitForNextPaint(() => {\n    const rect = NodeUtilities.getBoundingClientRectAsPlainObject(element)\n    InteractionHandling.scrollToAnchor(anchor, rect)\n  })\n}\n\n/**\n * Removes highlight class from any highlighted elements\n * @return {void}\n */\nconst removeHighlightsFromHighlightedElements = () => {\n  if (!document) {\n    return\n  }\n  const selector = `.${PCS_CSS_CLASS_ELEMENT_HIGHLIGHT}`\n  let element = document.querySelector(selector)\n  while (element) {\n    element.classList.remove(PCS_CSS_CLASS_ELEMENT_HIGHLIGHT)\n    element = document.querySelector(selector)\n  }\n}\n\n/**\n * Gets the lead image for a page\n * @private\n * @param {!Array} metaTags\n * @return {!map}\n */\nconst getLeadImageFromMetaTags = metaTags => {\n  const image = {}\n  const leadImageProperty = 'mw:leadImage'\n  for (let i = 0; i < metaTags.length; i++) {\n    const metaTag = metaTags[i]\n    const property = metaTag.getAttribute('property')\n    if (!property || property !== leadImageProperty) {\n      continue\n    }\n    image.source =  metaTag.getAttribute('content')\n    const widthString = metaTag.getAttribute('data-file-width')\n    if (widthString) {\n      image.width = parseInt(widthString, 10)\n    }\n    const heightString = metaTag.getAttribute('data-file-height')\n    if (heightString) {\n      image.height = parseInt(heightString, 10)\n    }\n    break\n  }\n  return image\n}\n\n/**\n * Gets the lead image for a page\n * @return {!map}\n */\nconst getLeadImage = () => getLeadImageFromMetaTags(getMetaTags())\n\n/**\n * Gets the Scroller object. Just for testing!\n * @return {{setScrollTop, scrollWithDecorOffset}}\n */\nconst getScroller = () => Scroller\n\n/**\n * Executes pagelib functionality intended to run before any content has loaded\n * @return {void}\n */\nconst onBodyStart = () => {\n  if (!document) {\n    return\n  }\n\n  // eslint-disable-next-line no-undef\n  if (typeof pcsClient !== 'undefined' && pcsClient.getSetupSettings) {\n    // eslint-disable-next-line no-undef\n    const setupJSON = pcsClient.getSetupSettings()\n    document.pcsSetupSettings = JSON.parse(setupJSON)\n  }\n\n  // eslint-disable-next-line no-undef\n  if (typeof pcsClient !== 'undefined' && pcsClient.onReceiveMessage) {\n    document.pcsActionHandler = action => {\n      // eslint-disable-next-line no-undef\n      pcsClient.onReceiveMessage(JSON.stringify(action))\n    }\n  }\n\n  if (document.pcsActionHandler) {\n    InteractionHandling.setInteractionHandler(document.pcsActionHandler)\n  } else {\n    // eslint-disable-next-line no-console\n    InteractionHandling.setInteractionHandler(action => console.log(action))\n  }\n  // eslint-disable-next-line require-jsdoc\n  const initialSetupCompletion = () => {\n    InteractionHandling.initialSetupComplete()\n  }\n  if (document.pcsSetupSettings) {\n    const preSettings = {\n      margins: document.pcsSetupSettings.margins,\n      leadImageHeight: document.pcsSetupSettings.leadImageHeight,\n      userGroups: document.pcsSetupSettings.userGroups,\n      theme: document.pcsSetupSettings.theme,\n      platform: document.pcsSetupSettings.platform,\n      loadImages: false,\n      setupTableEventHandling: false\n    }\n    setup(preSettings, initialSetupCompletion)\n    return\n  }\n\n  const defaultInitialSettings = {\n    loadImages: false,\n    setupTableEventHandling: false\n  }\n\n  const href = document.location && document.location.href\n  if (href) {\n    const match = href.match(/[?&]theme=([a-z]+)(?:&|$)/)\n    if (match && match.length > 1) {\n      defaultInitialSettings.theme = match[1]\n    }\n  }\n\n  setup(defaultInitialSettings, initialSetupCompletion)\n}\n\n/**\n * Executes pagelib functionality intended to run after all content has loaded\n * @return {void}\n */\nconst onBodyEnd = () => {\n  if (!document) {\n    return\n  }\n  let remainingContentTimeout = 100\n\n  /**\n   * Executed when final setup is complete\n   * @return {void}\n   */\n  const finalSetupComplete = () => {\n    InteractionHandling.finalSetupComplete()\n  }\n  if (document.pcsSetupSettings) {\n    const postSettings = document.pcsSetupSettings\n    delete postSettings.theme\n    delete postSettings.margins\n    delete postSettings.userGroups\n    delete postSettings.leadImageHeight\n    delete postSettings.platform\n    postSettings.setupTableEventHandling = true\n    setup(postSettings, finalSetupComplete)\n    remainingContentTimeout = document.pcsSetupSettings.remainingTimeout || remainingContentTimeout\n  } else {\n    setup({ setupTableEventHandling: true, areTablesInitiallyExpanded: true }, finalSetupComplete)\n  }\n\n  setTimeout(() => {\n    const sections = document.querySelectorAll('section')\n    for (let i = 1; i < sections.length; i++) {\n      sections[i].style.display = ''\n    }\n  }, remainingContentTimeout)\n}\n\nexport default {\n  onBodyStart,\n  onBodyEnd,\n  setup,\n  setTheme,\n  setDimImages,\n  setMargins,\n  setScrollTop,\n  setTextSizeAdjustmentPercentage,\n  setEditButtons,\n  getLeadImage,\n  getProtection,\n  getRevision,\n  getTableOfContents,\n  prepareForScrollToAnchor,\n  removeHighlightsFromHighlightedElements,\n  testing: {\n    getScroller\n  }\n}","import PlatformTransform from '../../transform/PlatformTransform'\n\nconst Platforms = PlatformTransform.CLASS\n\nexport default {\n  ANDROID: Platforms.ANDROID,\n  IOS: Platforms.IOS\n}","import SectionUtilities from '../../transform/SectionUtilities'\n\n/**\n * Hide or unhide a section.\n * @param {!string} sectionId\n * @param {?boolean} hidden\n * @return {void}\n */\nconst setHidden = (sectionId, hidden) => {\n  if (!document) {\n    return\n  }\n  SectionUtilities.setHidden(document, sectionId, hidden)\n}\n\nexport default {\n  getOffsets: SectionUtilities.getSectionOffsets,\n  setHidden\n}","import ThemeTransform from '../../transform/ThemeTransform'\n\nconst Themes = ThemeTransform.THEME\n\nexport default {\n  DEFAULT: Themes.DEFAULT,\n  DARK: Themes.DARK,\n  SEPIA: Themes.SEPIA,\n  BLACK: Themes.BLACK\n}"],"sourceRoot":""}